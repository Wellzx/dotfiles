"use strict";(("undefined"!=typeof self?self:global).webpackChunkclient_web=("undefined"!=typeof self?self:global).webpackChunkclient_web||[]).push([[4483],{62374:(e,t,i)=>{i.d(t,{h:()=>p});var s=i(62764),a=i(30758),l=i(96964),n=i(39822),r=i(79458),o=i(28903),d=i(16723),u=i(53611),c=i(66415),m=i(90198).Ay.textarea.withConfig({displayName:"Textarea",componentId:"sc-7bfmzb-0"})(["",";",";margin-block:0;border-radius:",";padding:",";",";"],(function(e){return(0,d.x4)(e.$useBrowserDefaultFocusStyle)}),(0,u.W)(),(0,c.AN)("base","4px"),(function(e){return"small"===e.$size?(0,c.po)("tighter-2"):(0,c.po)("tighter")}),(function(e){return(0,d.Hb)({isUsingKeyboard:e.$isUsingKeyboard,isHover:e.$isHover,isFocus:e.$isFocus,error:e.$error,useBrowserDefaultFocusStyle:e.$useBrowserDefaultFocusStyle})})),v=["size","error","isHover","isFocus","className"],p=a.forwardRef((function(e,t){var i=e.size,d=void 0===i?"medium":i,u=e.error,p=e.isHover,b=e.isFocus,f=e.className,y=(0,s.A)(e,v),g=(0,a.useContext)(n.E).isUsingKeyboard,h=(0,a.useContext)(l.g).useBrowserDefaultFocusStyle;return a.createElement(m,Object.assign({ref:t,className:(0,o.ZP)([(0,c.W3)("small"===d?"bodySmall":"bodyMedium")],f),"aria-invalid":u,$isUsingKeyboard:g,$useBrowserDefaultFocusStyle:h,$size:d,$isHover:p,$isFocus:b,$error:u,"data-encore-id":r.j.FormTextarea},y))}))},65121:(e,t,i)=>{i.d(t,{C:()=>l});var s=i(62411),a=i(26062);const l=()=>{const e=(0,s.d4)((e=>e.session?.user));return e?{type:a.c.USER,uri:e.uri,username:e.id,displayName:e.display_name??null,images:e.images.map((({url:e,width:t,height:i})=>({url:e,width:t||void 0,height:i||void 0})))}:null}},69747:(e,t,i)=>{i.d(t,{BP:()=>a});var s=i(30758);const a=(0,s.createContext)(null);(0,s.createContext)(null),(0,s.createContext)(null),(0,s.createContext)(null),(0,s.createContext)(null),(0,s.createContext)({})},72580:(e,t,i)=>{i.d(t,{DeleteCommentDialog:()=>u});var s=i(30758),a=i(62411),l=i(17160),n=i(13929),r=i(12205),o=i(71297),d=i(86070);const u=()=>{const e=(0,a.wA)(),{logCancelDeleteComment:t}=(0,r._)(),{isOpen:i,onConfirm:u}=(0,a.d4)((e=>e.ui.deleteCommentDialog)),c=(0,s.useCallback)((()=>{t(),e(o.FR.actions.close())}),[e,t]),m=(0,s.useCallback)((()=>{u(),e(o.FR.actions.close())}),[e,u]);return(0,d.jsx)(n.T,{isOpen:i,"aria-label":l.Ru.get("web-player.user-comments.delete-comment-dialog.title"),titleText:l.Ru.get("web-player.user-comments.delete-comment-dialog.title"),descriptionText:l.Ru.get("web-player.user-comments.delete-comment-dialog.subtitle"),onConfirm:m,onClose:c,confirmText:l.Ru.get("contextmenu.delete"),confirmLabel:l.Ru.get("contextmenu.delete"),cancelText:l.Ru.get("queue.cancel-button")})}},98670:(e,t,i)=>{i.d(t,{CommentsList:()=>Ne});var s=i(30758),a=i(97500),l=i.n(a),n=i(60749),r=i(15294),o=i(9641),d=i(37356),u=i(49393),c=i(98715),m=i(17160),v=i(17473),p=i(93892),b=i(62374),f=i(92574),y=i(73547),g=i(9820),h=i(86070);const x=({url:e,title:t})=>{const{openURLWithSessionTransfer:i}=(0,g.L)(),a=(0,s.useCallback)((()=>{i(e)}),[i,e]);return(0,h.jsx)(y.Y,{semanticColor:"textBase",onClick:a,children:t})},R=()=>(0,h.jsx)(x,{url:"https://www.spotify.com/safetyandprivacy/platform-rules",title:m.Ru.get("web-player.user-comments.trust-safety-modal.terms-conditions.platform-rules")});var C=i(12414),w=i(69747),S=i(2135),j=i(44170),P=i(51154),D=i(17713);const I=new WeakMap;var O=i(88008),E=i(39753),B=i(84940),V=i(92163);function k(e,t){let{isDisabled:i,name:s,validationBehavior:a="aria"}=e,{isInvalid:l,validationErrors:n,validationDetails:r}=t.displayValidation,{labelProps:o,fieldProps:d,descriptionProps:u,errorMessageProps:c}=(0,B.M)({...e,labelElementType:"span",isInvalid:l,errorMessage:e.errorMessage||n});I.set(t,{name:s,descriptionId:u.id,errorMessageId:c.id,validationBehavior:a});let m=(0,O.$)(e,{labelable:!0}),{focusWithinProps:v}=(0,V.R)({onBlurWithin:e.onBlur,onFocusWithin:e.onFocus,onFocusWithinChange:e.onFocusChange});return{groupProps:(0,E.v)(m,{role:"group","aria-disabled":i||void 0,...d,...v}),labelProps:o,descriptionProps:u,errorMessageProps:c,isInvalid:l,validationErrors:n,validationDetails:r}}var F=i(27283),N=i(1312),M=i(66983),q=i(9504),$=i(19238);function K(e,t,i){let{isDisabled:s=!1,isReadOnly:a=!1,value:l,name:n,children:r,"aria-label":o,"aria-labelledby":d,validationState:u="valid",isInvalid:c}=e;let{pressProps:m,isPressed:v}=(0,M.d)({isDisabled:s}),{pressProps:p,isPressed:b}=(0,M.d)({onPress(){var e;t.toggle(),null===(e=i.current)||void 0===e||e.focus()},isDisabled:s||a}),{focusableProps:f}=(0,$.Wc)(e,i),y=(0,E.v)(m,f),g=(0,O.$)(e,{labelable:!0});return(0,q.F)(i,t.isSelected,t.setSelected),{labelProps:(0,E.v)(p,{onClick:e=>e.preventDefault()}),inputProps:(0,E.v)(g,{"aria-invalid":c||"invalid"===u||void 0,"aria-errormessage":e["aria-errormessage"],"aria-controls":e["aria-controls"],"aria-readonly":a||void 0,onChange:e=>{e.stopPropagation(),t.setSelected(e.target.checked)},disabled:s,...null==l?{}:{value:l},name:n,type:"checkbox",...y}),isSelected:t.isSelected,isPressed:v||b,isDisabled:s,isReadOnly:a,isInvalid:c||"invalid"===u}}function T(e,t,i){let a=(0,F.KZ)({...e,value:t.isSelected}),{isInvalid:l,validationErrors:n,validationDetails:r}=a.displayValidation,{labelProps:o,inputProps:d,isSelected:u,isPressed:c,isDisabled:m,isReadOnly:v}=K({...e,isInvalid:l},t,i);(0,N.X)(e,a,i);let{isIndeterminate:p,isRequired:b,validationBehavior:f="aria"}=e;(0,s.useEffect)((()=>{i.current&&(i.current.indeterminate=!!p)}));let{pressProps:y}=(0,M.d)({isDisabled:m||v,onPress(){let{[F.Lf]:t}=e,{commitValidation:i}=t||a;i()}});return{labelProps:(0,E.v)(o,y),inputProps:{...d,checked:u,"aria-required":b&&"aria"===f||void 0,required:b&&"native"===f},isSelected:u,isPressed:c,isDisabled:m,isReadOnly:v,isInvalid:l,validationErrors:n,validationDetails:r}}var A=i(80115);function L(e={}){let{isReadOnly:t}=e,[i,s]=(0,A.P)(e.isSelected,e.defaultSelected||!1,e.onChange);return{isSelected:i,setSelected:function(e){t||s(e)},toggle:function(){t||s(!i)}}}function U(e,t,i){const a=L({isReadOnly:e.isReadOnly||t.isReadOnly,isSelected:t.isSelected(e.value),onChange(i){i?t.addValue(e.value):t.removeValue(e.value),e.onChange&&e.onChange(i)}});let{name:l,descriptionId:n,errorMessageId:r,validationBehavior:o}=I.get(t);var d;o=null!==(d=e.validationBehavior)&&void 0!==d?d:o;let{realtimeValidation:u}=(0,F.KZ)({...e,value:a.isSelected,name:void 0,validationBehavior:"aria"}),c=(0,s.useRef)(F.YD),m=()=>{t.setInvalid(e.value,u.isInvalid?u:c.current)};(0,s.useEffect)(m);let v=t.realtimeValidation.isInvalid?t.realtimeValidation:u,p="native"===o?t.displayValidation:v;var b;let f=T({...e,isReadOnly:e.isReadOnly||t.isReadOnly,isDisabled:e.isDisabled||t.isDisabled,name:e.name||l,isRequired:null!==(b=e.isRequired)&&void 0!==b?b:t.isRequired,validationBehavior:o,[F.Lf]:{realtimeValidation:v,displayValidation:p,resetValidation:t.resetValidation,commitValidation:t.commitValidation,updateValidation(e){c.current=e,m()}}},a,i);return{...f,inputProps:{...f.inputProps,"aria-describedby":[e["aria-describedby"],t.isInvalid?r:null,n].filter(Boolean).join(" ")||void 0}}}var H=i(5877),z=i(37096),W=i(57853);function _(e={}){let[t,i]=(0,A.P)(e.value,e.defaultValue||[],e.onChange),a=!!e.isRequired&&0===t.length,l=(0,s.useRef)(new Map),n=(0,F.KZ)({...e,value:t}),r=n.displayValidation.isInvalid;var o;return{...n,value:t,setValue(t){e.isReadOnly||e.isDisabled||i(t)},isDisabled:e.isDisabled||!1,isReadOnly:e.isReadOnly||!1,isSelected:e=>t.includes(e),addValue(s){e.isReadOnly||e.isDisabled||t.includes(s)||i(t.concat(s))},removeValue(s){e.isReadOnly||e.isDisabled||t.includes(s)&&i(t.filter((e=>e!==s)))},toggleValue(s){e.isReadOnly||e.isDisabled||(t.includes(s)?i(t.filter((e=>e!==s))):i(t.concat(s)))},setInvalid(e,t){let i=new Map(l.current);t.isInvalid?i.set(e,t):i.delete(e),l.current=i,n.updateValidation((0,F.cX)(...i.values()))},validationState:null!==(o=e.validationState)&&void 0!==o?o:r?"invalid":null,isInvalid:r,isRequired:a}}var Y=i(91939),Z=i(29946);const X=(0,s.createContext)(null),G=(0,s.createContext)(null),J=(0,s.forwardRef)((function(e,t){[e,t]=(0,S.JT)(e,t,X);let{validationBehavior:i}=(0,S.CC)(C.c)||{};var a,l;let n=null!==(l=null!==(a=e.validationBehavior)&&void 0!==a?a:i)&&void 0!==l?l:"native",r=_({...e,validationBehavior:n}),[o,d]=(0,S._E)(!e["aria-label"]&&!e["aria-labelledby"]),{groupProps:u,labelProps:c,descriptionProps:m,errorMessageProps:v,...p}=k({...e,label:d,validationBehavior:n},r),b=(0,S.Sl)({...e,values:{isDisabled:r.isDisabled,isReadOnly:r.isReadOnly,isRequired:e.isRequired||!1,isInvalid:r.isInvalid,state:r},defaultClassName:"react-aria-CheckboxGroup"});return s.createElement("div",{...u,...b,ref:t,slot:e.slot||void 0,"data-readonly":r.isReadOnly||void 0,"data-required":e.isRequired||void 0,"data-invalid":r.isInvalid||void 0,"data-disabled":e.isDisabled||void 0},s.createElement(S.Kq,{values:[[G,r],[P.I,{...c,ref:o,elementType:"span"}],[D.h,{slots:{description:m,errorMessage:v}}],[j.C,p]]},b.children))})),Q=(0,s.forwardRef)((function(e,t){let{inputRef:i=null,...a}=e;[e,t]=(0,S.JT)(a,t,w.BP);let{validationBehavior:l}=(0,S.CC)(C.c)||{};var n,r;let o=null!==(r=null!==(n=e.validationBehavior)&&void 0!==n?n:l)&&void 0!==r?r:"native",d=(0,s.useContext)(G),u=(0,Y.U)((0,Z.P)(i,void 0!==e.inputRef?e.inputRef:null)),{labelProps:c,inputProps:m,isSelected:v,isDisabled:p,isReadOnly:b,isPressed:f,isInvalid:y}=d?U({...(0,S.SK)(e),value:e.value,children:"function"==typeof e.children||e.children},d,u):T({...(0,S.SK)(e),children:"function"==typeof e.children||e.children,validationBehavior:o},L(e),u),{isFocused:g,isFocusVisible:h,focusProps:x}=(0,H.o)(),R=p||b,{hoverProps:j,isHovered:P}=(0,z.M)({...e,isDisabled:R}),D=(0,S.Sl)({...e,defaultClassName:"react-aria-Checkbox",values:{isSelected:v,isIndeterminate:e.isIndeterminate||!1,isPressed:f,isHovered:P,isFocused:g,isFocusVisible:h,isDisabled:p,isReadOnly:b,isInvalid:y,isRequired:e.isRequired||!1}}),I=(0,O.$)(e);return delete I.id,s.createElement("label",{...(0,E.v)(I,c,j,D),ref:t,slot:e.slot||void 0,"data-selected":v||void 0,"data-indeterminate":e.isIndeterminate||void 0,"data-pressed":f||void 0,"data-hovered":P||void 0,"data-focused":g||void 0,"data-focus-visible":h||void 0,"data-disabled":p||void 0,"data-readonly":b||void 0,"data-invalid":y||void 0,"data-required":e.isRequired||void 0},s.createElement(W.s,{elementType:"span"},s.createElement("input",{...(0,E.v)(m,x),ref:u})),D.children)}));var ee=i(82026),te=i(21932);const ie=()=>(0,h.jsx)(x,{url:"https://www.spotify.com/se/legal/end-user-agreement/",title:m.Ru.get("web-player.user-comments.trust-safety-modal.terms-conditions.terms-of-use")});var se=i(80054);const ae="LTw1rQOh8jedxHmEmV5Y",le="FgLVUdYnnnDyo2qiCXUN",ne="mXPudEv1VY8KNOdLMcqj",re="CNxfpLOVnZR2mz_iBYro",oe="kjwqPxVbTBKOEKtP8CR6",de=()=>(0,h.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"32",height:"32",viewBox:"0 0 32 32",fill:"none",className:re,children:(0,h.jsx)("path",{d:"M2.33333 15.9997C2.33333 8.45196 8.45228 2.33301 16 2.33301C23.5477 2.33301 29.6667 8.45196 29.6667 15.9997C29.6667 23.5474 23.5477 29.6663 16 29.6663C8.45228 29.6663 2.33333 23.5474 2.33333 15.9997Z",strokeWidth:"2"})});var ue=i(76180);const ce=({value:e,title:t,subtitle:i})=>(0,h.jsx)(Q,{className:ne,value:e,isRequired:!0,"aria-describedby":ue.bA,children:({isSelected:e})=>(0,h.jsxs)(h.Fragment,{children:[e?(0,h.jsx)(se.k,{size:"large",semanticColor:"textBrightAccent"}):(0,h.jsx)(de,{}),(0,h.jsxs)("div",{className:oe,children:[(0,h.jsx)(c.E,{variant:"bodyMediumBold",semanticColor:"textBase",children:t}),(0,h.jsx)(c.E,{variant:"bodySmall",semanticColor:"textBase",children:i})]})]})});var me=i(12205),ve=i(32861),pe=i(59109),be=i(96258);const fe=(0,ve.y)((()=>!1)),ye=e=>fe.setState(e),ge=()=>{const[e,t]=(0,be.x)("user-comments-approved-conditions",!1);return{isOpen:(0,pe.P)(fe),setModalOpenState:ye,hasApproved:e,setHasApproved:t}},he=()=>{const{isOpen:e,setModalOpenState:t,setHasApproved:i}=ge(),{logCommentConsentAccepted:a}=(0,me._)(),[l,n]=(0,s.useState)(!1);return(0,s.useEffect)((()=>{e||n(!1)}),[e]),(0,h.jsx)(te.A,{isOpen:e,onRequestClose:()=>t(!1),children:(0,h.jsx)(C.l,{onInvalid:e=>{e.preventDefault(),n(!0),!(document.activeElement instanceof HTMLInputElement)&&e.target instanceof HTMLInputElement&&e.target.focus()},onSubmit:e=>{e.preventDefault(),n(!1),a(),i(!0),t(!1)},children:(0,h.jsx)(J,{children:(0,h.jsxs)("div",{className:ae,children:[(0,h.jsxs)("div",{className:le,children:[(0,h.jsx)(c.E,{variant:"titleSmall",semanticColor:"textBase",children:m.Ru.get("web-player.user-comments.trust-safety-modal.title")}),(0,h.jsx)(c.E,{variant:"bodySmall",children:m.Ru.get("web-player.user-comments.trust-safety-modal.subtitle")})]}),(0,h.jsxs)(ee.a,{variant:"tinted",padding:"16px 24px",children:[(0,h.jsx)(ce,{title:m.Ru.get("web-player.user-comments.trust-safety-modal.row-1.title"),subtitle:m.Ru.get("web-player.user-comments.trust-safety-modal.row-1.subtitle"),value:"public"}),(0,h.jsx)(ce,{title:m.Ru.get("web-player.user-comments.trust-safety-modal.row-2.title"),subtitle:m.Ru.get("web-player.user-comments.trust-safety-modal.row-2.subtitle"),value:"review"}),(0,h.jsx)(ce,{title:m.Ru.get("web-player.user-comments.trust-safety-modal.row-3.title"),subtitle:m.Ru.get("web-player.user-comments.trust-safety-modal.row-3.subtitle"),value:"safety"})]}),(0,h.jsx)(c.E,{semanticColor:"textSubdued",variant:"bodySmall",children:m.Ru.get("web-player.user-comments.trust-safety-modal.terms-conditions",{platformRules:(0,h.jsx)(R,{}),termsOfUse:(0,h.jsx)(ie,{})})}),l&&(0,h.jsx)(c.E,{variant:"bodySmall",semanticColor:"textNegative",id:ue.bA,children:m.Ru.get("web-player.user-comments.trust-safety-modal.agree-to-continue")}),(0,h.jsx)(f.$,{size:"large",type:"submit",children:m.Ru.get("web-player.user-comments.trust-safety-modal.submit")})]})})})})};var xe=i(90282);const Re="EzubtLtLldmRrerGnzHG",Ce="WJoPBwb17TQkdjM85AjA",we="LIPKVT33tO8QKqsCDMiD",Se="Sts43e3FSkhLlkgWo3fC",je=e=>e<=10?"textNegative":e<=20?"textWarning":"textSubdued",Pe=({addComment:e,autoFocusInput:t})=>{const[i,a]=(0,s.useState)(""),l=(0,s.useRef)(null),{hasApproved:n,setModalOpenState:r}=ge();(0,xe.i)({ref:t?l:{current:null},preventScroll:!0,deps:[t]});const o=i.length,d=500-o,u=d<0||0===o,v=(0,s.useCallback)((()=>{u||(e(i),a(""))}),[e,u,i]),p=(0,s.useCallback)((e=>{e.preventDefault(),v()}),[v]),y=(0,s.useCallback)((e=>{if(!n)return e.preventDefault(),void r(!0)}),[n,r]),g=(0,s.useCallback)((e=>{if(!n)return e.preventDefault(),void r(!0);"Enter"===e.key&&e.metaKey&&v()}),[n,r,v]),x=(0,s.useCallback)((e=>{e.target.style.height="auto",e.target.style.height=`${e.target.scrollHeight}px`,a(e.target.value)}),[]);return(0,h.jsxs)(h.Fragment,{children:[(0,h.jsxs)("form",{className:Ce,onSubmit:p,children:[(0,h.jsx)(b.h,{ref:l,className:Re,size:"small",placeholder:m.Ru.get("web-player.user-comments.comment-input.leave-comment"),onChange:x,onKeyDown:g,onClick:y}),(0,h.jsxs)("div",{className:we,children:[(0,h.jsx)(c.E,{semanticColor:"textSubdued",variant:"bodySmall",children:m.Ru.get("web-player.user-comments.comment-input.platform-rules",{platformRules:(0,h.jsx)(R,{})})}),(0,h.jsxs)("div",{className:Se,children:[(0,h.jsx)(c.E,{semanticColor:je(d),variant:"bodySmall",children:d}),(0,h.jsx)(f.$,{type:"submit",size:"small","aria-disabled":u,children:m.Ru.get("web-player.user-comments.comment")})]})]})]}),(0,h.jsx)(he,{})]})};var De=i(18669);const Ie=({entityUri:e,comments:t,addComment:i,user:a,isRestricted:l})=>{const r=(0,s.useRef)(null),[o]=(0,n.ok)(),{logSubmitComment:d}=(0,me._)(),u="new"===o.get("id")||"top"===o.get("id"),b="new"===o.get("id");(0,s.useEffect)((()=>{u&&r.current&&r.current.scrollIntoView({block:"start"})}),[u]);const f=(0,s.useCallback)((t=>{d(e),i(t)}),[i,e,d]),y=0===t.totalCount;return(0,h.jsxs)(h.Fragment,{children:[(0,h.jsx)(c.E,{variant:"titleSmall",semanticColor:"textBase",ref:r,children:y?m.Ru.get("web-player.user-comments.comments"):m.Ru.get("web-player.user-comments.comment-list-header.count",t.totalCount)}),(0,h.jsxs)("div",{className:De.A.header,children:[(0,h.jsx)(p.K,{eligibility:t.eligibilityStatus}),!l&&(0,h.jsxs)(h.Fragment,{children:[(0,h.jsx)(v.e,{label:a.displayName||a.username,width:32,images:a?.images,userIconSize:"small",testID:"user-widget-avatar"}),(0,h.jsx)(Pe,{addComment:f,autoFocusInput:b})]})]}),!l&&y&&(0,h.jsx)(c.E,{variant:"bodySmall",semanticColor:"textSubdued",children:m.Ru.get("web-player.user-comments.comment-input.first-comment")})]})};var Oe=i(57311),Ee=i(66232),Be=i(28485),Ve=i(65121),ke=i(76404);const Fe=({commentsResponse:e,entityUri:t,user:i,className:a})=>{const{fetchNextPage:c,addComment:m}=(0,o.$)(t),[v]=(0,n.ok)(),{logCommentsListEntityPageImpression:p}=(0,me._)();(0,s.useEffect)((()=>{p(t)}),[]);const b=(0,s.useMemo)((()=>e.comments.filter((e=>!e.isSensitive))),[e]),f=(0,s.useMemo)((()=>e.comments.filter((e=>e.isSensitive))),[e]),y=(0,Ee.n)(t),{isRestricted:g}=(0,Be.K)(e.eligibilityStatus);return(0,h.jsxs)("div",{className:l()(De.A.container,a),style:{"--transition-duration":`${ue.xt}ms`},children:[(0,h.jsx)(Ie,{entityUri:t,comments:e,addComment:m,user:i,isRestricted:g}),(0,h.jsx)(r.B,{children:(0,h.jsxs)(ke._,{onReachBottom:c,children:[(0,h.jsx)(d.Y,{comments:b,renderComment:(e,i)=>(0,h.jsx)(u.c,{comment:e,entityUri:t,showSeparator:i>0,scrollIntoViewOnMount:v.get("id")===e.id,collapseReplies:!1,creatorReactionName:y})}),(0,h.jsx)(Oe.U,{sensitiveComments:f,entityUri:t,scrollIntoViewOnMount:v.get("id")===ue.bM})]})})]})},Ne=({uri:e,className:t})=>{const{data:i}=(0,o.$)(e),s=(0,Ve.C)();if(!i||!s)return null;const{isHidden:a}=(0,Be.K)(i.eligibilityStatus);return a?null:(0,h.jsx)(Fe,{commentsResponse:i,entityUri:e,user:s,className:t})}}}]);
//# sourceMappingURL=dwp-user-comments.js.map