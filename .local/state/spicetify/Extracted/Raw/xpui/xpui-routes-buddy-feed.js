"use strict";(("undefined"!=typeof self?self:global).webpackChunkclient_web=("undefined"!=typeof self?self:global).webpackChunkclient_web||[]).push([[7564],{32335:(t,e,a)=>{a.r(e),a.d(e,{default:()=>Vt});var n=a(30758);const i="music",o="2.0.0",r="default",s="12.2.0";function c(t){return new l(t)}class l{constructor(t){this._path=[{name:"desktop-friend-activity"}],t?.parentAbsoluteLocation&&(this._parentAbsoluteLocation=t.parentAbsoluteLocation)}addFriendButtonFactory(){return new l.AddFriendButtonEventFactory({path:this._path,parentAbsoluteLocation:this._parentAbsoluteLocation})}closeButtonFactory(){return new l.CloseButtonEventFactory({path:this._path,parentAbsoluteLocation:this._parentAbsoluteLocation})}friendRowFactory(){return new l.FriendRowEventFactory({path:this._path,parentAbsoluteLocation:this._parentAbsoluteLocation})}_getCurrentLocation(){return{pathNodes:this._path,specMode:[r,...[...Array(this._path.length-1)].map((()=>""))],specVersion:[o,...[...Array(this._path.length-1)].map((()=>""))]}}getAbsoluteLocation(){const t=this._parentAbsoluteLocation?.locations;return{locations:[...t||[],this._getCurrentLocation()]}}impression(){return{app:i,generatorVersion:s,specificationVersion:o,specificationMode:r,annotatorConfigurationVersion:"",annotatorVersion:"",location:this._getCurrentLocation(),parentAbsoluteLocation:this._parentAbsoluteLocation}}}!function(t){t.AddFriendButtonEventFactory=class{constructor({path:t,parentAbsoluteLocation:e,data:a}){this._path=t.concat({name:"add_friend_button"}),e&&(this._parentAbsoluteLocation=e)}_getCurrentLocation(){return{pathNodes:this._path,specMode:[r,...[...Array(this._path.length-1)].map((()=>""))],specVersion:[o,...[...Array(this._path.length-1)].map((()=>""))]}}getAbsoluteLocation(){const t=this._parentAbsoluteLocation?.locations;return{locations:[...t||[],this._getCurrentLocation()]}}hitUiReveal(){return{actionName:"ui_reveal",actionVersion:1,app:i,generatorVersion:s,interactionType:"hit",specificationMode:r,specificationVersion:o,annotatorConfigurationVersion:"",annotatorVersion:"",location:this._getCurrentLocation(),parentAbsoluteLocation:this._parentAbsoluteLocation}}}}(l||(l={})),function(t){t.CloseButtonEventFactory=class{constructor({path:t,parentAbsoluteLocation:e,data:a}){this._path=t.concat({name:"close_button"}),e&&(this._parentAbsoluteLocation=e)}_getCurrentLocation(){return{pathNodes:this._path,specMode:[r,...[...Array(this._path.length-1)].map((()=>""))],specVersion:[o,...[...Array(this._path.length-1)].map((()=>""))]}}getAbsoluteLocation(){const t=this._parentAbsoluteLocation?.locations;return{locations:[...t||[],this._getCurrentLocation()]}}hitUiHide(){return{actionName:"ui_hide",actionVersion:1,app:i,generatorVersion:s,interactionType:"hit",specificationMode:r,specificationVersion:o,annotatorConfigurationVersion:"",annotatorVersion:"",location:this._getCurrentLocation(),parentAbsoluteLocation:this._parentAbsoluteLocation}}}}(l||(l={})),function(t){t.FriendRowEventFactory=class{constructor({path:t,parentAbsoluteLocation:e,data:a}){this._path=t.concat({name:"friend_row"}),e&&(this._parentAbsoluteLocation=e)}playButtonFactory(){return new t.FriendRowEventFactory.PlayButtonEventFactory({path:this._path,parentAbsoluteLocation:this._parentAbsoluteLocation})}friendRowLinkFactory(e){return new t.FriendRowEventFactory.FriendRowLinkEventFactory({path:this._path,parentAbsoluteLocation:this._parentAbsoluteLocation,data:e})}_getCurrentLocation(){return{pathNodes:this._path,specMode:[r,...[...Array(this._path.length-1)].map((()=>""))],specVersion:[o,...[...Array(this._path.length-1)].map((()=>""))]}}getAbsoluteLocation(){const t=this._parentAbsoluteLocation?.locations;return{locations:[...t||[],this._getCurrentLocation()]}}}}(l||(l={})),function(t){!function(t){t.PlayButtonEventFactory=class{constructor({path:t,parentAbsoluteLocation:e,data:a}){this._path=t.concat({name:"play_button"}),e&&(this._parentAbsoluteLocation=e)}_getCurrentLocation(){return{pathNodes:this._path,specMode:[r,...[...Array(this._path.length-1)].map((()=>""))],specVersion:[o,...[...Array(this._path.length-1)].map((()=>""))]}}getAbsoluteLocation(){const t=this._parentAbsoluteLocation?.locations;return{locations:[...t||[],this._getCurrentLocation()]}}hitPlay({itemToBePlayed:t}){return{actionParameterNames:["item_to_be_played"],actionParameterValues:[t.toString()],actionName:"play",actionVersion:1,app:i,generatorVersion:s,interactionType:"hit",specificationMode:r,specificationVersion:o,annotatorConfigurationVersion:"",annotatorVersion:"",location:this._getCurrentLocation(),parentAbsoluteLocation:this._parentAbsoluteLocation}}hitPause({itemToBePaused:t}){return{actionParameterNames:["item_to_be_paused"],actionParameterValues:[t.toString()],actionName:"pause",actionVersion:1,app:i,generatorVersion:s,interactionType:"hit",specificationMode:r,specificationVersion:o,annotatorConfigurationVersion:"",annotatorVersion:"",location:this._getCurrentLocation(),parentAbsoluteLocation:this._parentAbsoluteLocation}}hitResume({itemToBeResumed:t}){return{actionParameterNames:["item_to_be_resumed"],actionParameterValues:[t.toString()],actionName:"resume",actionVersion:1,app:i,generatorVersion:s,interactionType:"hit",specificationMode:r,specificationVersion:o,annotatorConfigurationVersion:"",annotatorVersion:"",location:this._getCurrentLocation(),parentAbsoluteLocation:this._parentAbsoluteLocation}}}}(t.FriendRowEventFactory||(t.FriendRowEventFactory={}))}(l||(l={})),function(t){!function(t){t.FriendRowLinkEventFactory=class{constructor({path:t,parentAbsoluteLocation:e,data:a}){this._path=t.concat({...a,name:"friend_row_link"}),e&&(this._parentAbsoluteLocation=e)}_getCurrentLocation(){return{pathNodes:this._path,specMode:[r,...[...Array(this._path.length-1)].map((()=>""))],specVersion:[o,...[...Array(this._path.length-1)].map((()=>""))]}}getAbsoluteLocation(){const t=this._parentAbsoluteLocation?.locations;return{locations:[...t||[],this._getCurrentLocation()]}}hitUiNavigate({destination:t}){return{actionParameterNames:["destination"],actionParameterValues:[t.toString()],actionName:"ui_navigate",actionVersion:1,app:i,generatorVersion:s,interactionType:"hit",specificationMode:r,specificationVersion:o,annotatorConfigurationVersion:"",annotatorVersion:"",location:this._getCurrentLocation(),parentAbsoluteLocation:this._parentAbsoluteLocation}}}}(t.FriendRowEventFactory||(t.FriendRowEventFactory={}))}(l||(l={}));var u=a(17160),h=a(60749),d=a(98715),p=a(92574),m=a(97500),g=a.n(m),_=a(13173);const b="jGcEaPyhr1c_janM2uRF",L="OemaZktMXaRcYQ5bcfLZ",y="o5IJsOJEWBEyxtPVVVqQ",f="toPt7VOT_PiDx5Gj3SM2",x="xU4sacBisQneHoQeHMP5",A="srjSlmxMGzXnJBc32BJa",j="lju7xv10a5Y5Z8h8CcKJ",N="jr794VV4i2iUBRhfvS5i",v="KE3gK5ccLz2gL3dhJ4BW",V="pO2rsGFqUdaNhpLrif21",C="Ydxgl4Y23orfVVVI9O2k",w="VhqWrkzIrJrvdyj7ZXMd",F="T3liC_3fbMOTilR4HHKD",P="W_tr6AMQB9Chbc9bCS9w",R="yDdNxgieZmqjgHQCW3UE",S="aikUDGtqRnCX0ZwYHDUW",B="T_HXMW6n5qsbLbPTr1GS",E="tYswKV9PmtTCv62LOPIV",I="GlDNRQ2w0t4h9WBI4GgN",T="BQGSV5BvuAaJ5rmFAXLp",k="ZLbFjRdp1AMXebZH6UWM",M="jhtyHt6d9vbxK6VtCI7a",U="oCaGCB13zdReRutfBS8_",Q="MR1n58Qu0kPorQtveOCQ",G="y10vXronmQ6eYMlJrIp3";var D=a(86070);const O=({showOnlineIndicator:t})=>(0,D.jsxs)("div",{className:E,children:[(0,D.jsxs)("div",{className:I,children:[(0,D.jsx)(_.v,{size:"medium"}),t?(0,D.jsx)("div",{className:T}):null]}),(0,D.jsxs)("div",{className:k,children:[(0,D.jsx)("div",{className:g()(M,U)}),(0,D.jsx)("div",{className:M}),(0,D.jsx)("div",{className:M})]})]}),H=()=>(0,D.jsxs)("div",{"data-testid":"buddy-feed-empty-state",className:S,children:[(0,D.jsx)(d.E,{as:"p",className:B,children:u.Ru.get("buddy-feed.let-followers-see-your-listening")}),(0,D.jsx)(O,{showOnlineIndicator:!0}),(0,D.jsx)(O,{showOnlineIndicator:!0}),(0,D.jsx)(O,{}),(0,D.jsx)(d.E,{as:"p",className:B,children:u.Ru.get("buddy-feed.enable-share-listening-activity")}),(0,D.jsx)(h.N_,{to:"/preferences",className:Q,children:(0,D.jsx)(p.$,{colorSet:"invertedLight",className:G,children:u.Ru.get("desktop.settings.settings")})})]});var W=a(68832),Y=a(64871),Z=a(17473),J=a(67785),z=a(99361),K=a(82086),X=a(50876),q=a(34123),$=a(22248),tt=a(38223),et=a(28156),at=a(52139),nt=a(93890),it=a(60363),ot=a(55158);const rt=t=>{const{timestamp:e,isNowPlaying:a}=t;return a?(0,D.jsx)(it.Zp,{label:u.Ru.get("time.now"),children:(0,D.jsx)(nt.A,{"aria-label":u.Ru.get("time.now"),size:"small"})}):(0,D.jsx)("span",{children:(0,ot.Z)(e)})};var st=a(83898),ct=a(37641),lt=a(6585),ut=a(38684),ht=a(26062);const dt=t=>Date.now()-t<9e5,pt=(t,e)=>{const a=(0,Y.o_h)(t)?.type;switch(a){case Y.NQG.PLAYLIST:case Y.NQG.PLAYLIST_V2:return(0,D.jsx)(X.W,{uri:t});case Y.NQG.EPISODE:case Y.NQG.SHOW:return(0,D.jsx)(q.H,{uri:t});case Y.NQG.ALBUM:return(0,D.jsx)(z.h,{uri:t,artistUri:e});case Y.NQG.ARTIST:return(0,D.jsx)(K.t,{uri:t});default:return null}},mt=t=>{switch(t){case Y.NQG.ALBUM:return ht.c.ALBUM;case Y.NQG.ARTIST:return ht.c.ARTIST;case Y.NQG.SHOW:return ht.c.SHOW;case Y.NQG.EPISODE:return ht.c.EPISODE;case Y.NQG.PLAYLIST:case Y.NQG.PLAYLIST_V2:return ht.c.PLAYLIST;default:return}},gt=t=>{const{show:e=!0,spec:a,friend:i}=t,o=(0,n.useMemo)((()=>i.user.imageUrl?[{url:i.user.imageUrl,width:0,height:0}]:[]),[i.user.imageUrl]),r=(0,ut.s)(),s=i.track,c=s.uri,{togglePlay:l,isPlaying:h,isActive:p}=(0,lt.P)({uri:c},{featureIdentifier:"buddy_feed",referrerIdentifier:"buddy_feed"}),m=(0,Y.o_h)(s.context.uri),_=m?.type,L=(0,n.useCallback)((()=>{l();const t=a.friendRowFactory().playButtonFactory();p?h?r.logInteraction(t.hitPause({itemToBePaused:c})):r.logInteraction(t.hitResume({itemToBeResumed:c})):r.logInteraction(t.hitPlay({itemToBePlayed:c}))}),[h,c,a,p,l,r]),y=(0,n.useCallback)(((t,e)=>{r.logInteraction(a.friendRowFactory().friendRowLinkFactory({identifier:t}).hitUiNavigate({destination:e}))}),[r,a]),{draggable:f,onDragStart:S}=(0,st.P)({itemUris:[c],dragLabelText:s.name}),{draggable:B,onDragStart:E}=(0,st.P)({itemUris:[s.artist.uri],dragLabelText:s.artist.name}),{draggable:I,onDragStart:T}=(0,st.P)({itemUris:[s.context.uri],dragLabelText:s.context.name});return e?(0,D.jsxs)("div",{className:g()(b),children:[(0,D.jsx)(J.h,{menu:pt(s.context.uri,s.artist.uri),children:(0,D.jsxs)("div",{className:x,children:[(0,D.jsx)(Z.e,{label:i.user.name,width:40,userIconSize:"small",images:o,withBadge:dt(i.timestamp)}),(0,D.jsx)(at.x,{className:A,iconClassName:j,isPlaying:h,isLocked:!1,onClick:L,playAriaLabel:h?u.Ru.get("pause"):`${u.Ru.get("play")} ${s.artist.name} ${s.name}`})]})}),(0,D.jsxs)("div",{className:g()(N),children:[(0,D.jsxs)("div",{className:v,children:[(0,D.jsx)(d.E,{as:"p",variant:"bodySmallBold",className:g()(V,"ellipsis-one-line"),children:(0,D.jsx)(J.h,{menu:(0,D.jsx)(tt.B,{uri:i.user.uri}),children:(0,D.jsx)(et.N,{title:i.user.name,to:i.user.uri,dir:"auto",onClick:()=>y("profile_link",i.user.uri),children:i.user.name})})}),(0,D.jsx)(d.E,{as:"p",variant:"marginal",className:g()(C),children:(0,D.jsx)(rt,{timestamp:i.timestamp,isNowPlaying:dt(i.timestamp)})})]}),(0,D.jsxs)(d.E,{as:"p",variant:"marginal",className:w,children:[(0,D.jsx)(J.h,{menu:(0,D.jsx)($.P,{uri:s.uri,contextUri:s.context.uri,albumUri:s.album.uri,artists:[s.artist]}),children:(0,D.jsx)(et.N,{title:s.name,to:c,className:"ellipsis-one-line",dir:"auto",draggable:f,onDragStart:S,onClick:()=>y("track_link",c),children:s.name})}),(0,D.jsx)("span",{"aria-hidden":!0,children:" • "}),(0,D.jsx)(J.h,{menu:s.artist?(0,D.jsx)(K.t,{uri:s.artist.uri}):null,children:(0,D.jsx)(et.N,{title:s.artist.name,to:s.artist.uri,className:"ellipsis-one-line",dir:"auto",draggable:B,onDragStart:E,onClick:()=>y("artist_link",s.artist.uri),children:s.artist.name})})]}),(0,D.jsx)(d.E,{as:"p",variant:"marginal",className:g()("ellipsis-one-line",P),children:(0,D.jsx)(J.h,{menu:pt(s.context.uri,s.artist.uri),children:(0,D.jsxs)(et.N,{title:s.context.name,to:s.context.uri,className:R,draggable:I,onDragStart:T,onClick:()=>y("context_link",s.context.uri),children:[(0,D.jsx)(ct.s,{type:mt(_),iconSize:16,className:F}),(0,D.jsx)("span",{dir:"auto",className:"ellipsis-one-line",children:s.context.name})]})})})]})]},i.user.uri):null};var _t=a(38671),bt=a(48669),Lt=a(20039);function yt({friends:t,spec:e}){const{currentSession:a}=(0,Lt.D)(),i=(0,bt.y)(),[o,r]=(0,n.useState)(!0),s=!a?.active&&i&&o&&(0,D.jsx)("li",{className:y,children:(0,D.jsx)(_t.p,{localStorageKey:"dismissStartJamButtonFromFriendFeed",onDismiss:()=>r(!1)})},"start-jam-button");return(0,D.jsx)(W.ZI,{flipKey:t.map((t=>t.user.uri)).join(""),children:(0,D.jsxs)("ul",{className:L,children:[s,t.map(((t,a)=>(0,D.jsx)(W.lf,{flipId:t.user.uri,children:(0,D.jsx)("li",{children:(0,D.jsx)(gt,{friend:t,show:a<100,spec:e},t.user.uri)})},t.user.uri)))]})})}var ft=a(54657),xt=a(50694),At=a(31774),jt=a(42919),Nt=a(55354),vt=a(47900);const Vt=({friends:t})=>{const e=(0,ut.s)(),{spec:a}=(0,vt.r)(c,{}),i=(0,n.useRef)(null);(0,n.useEffect)((()=>{e.logImpression(a.impression())}),[e,a]);const o=0===t.length,r=(0,n.useCallback)((()=>{e.logInteraction(a.closeButtonFactory().hitUiHide())}),[e,a]);return(0,D.jsx)(Nt.ql.Provider,{value:"buddy_feed",children:(0,D.jsx)(ft._,{label:u.Ru.get("buddy-feed.friend-activity"),focusTransferId:"BUDDY-FEED",children:(0,D.jsx)("div",{className:f,ref:i,children:(0,D.jsx)(xt.w,{fixedHeader:(0,D.jsx)(At.a,{title:u.Ru.get("buddy-feed.friend-activity"),panel:jt.Z.BuddyFeed,onClose:r}),children:o?(0,D.jsx)(H,{}):(0,D.jsx)(yt,{friends:t,spec:a})})})})})}}}]);
//# sourceMappingURL=xpui-routes-buddy-feed.js.map