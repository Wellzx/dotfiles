"use strict";(("undefined"!=typeof self?self:global).webpackChunkclient_web=("undefined"!=typeof self?self:global).webpackChunkclient_web||[]).push([[3322],{26090:(e,t,a)=>{a.d(t,{w:()=>u});var i=a(30758),n=a(94703),s=a(17160),o=a(76688),r=a(6727),c=a(49284),l=a(47900);const u=({uri:e,isBook:t})=>{const{add:a,remove:u}=(0,c.p)("prerelease"),d=(0,r.o)("prerelease",[e]).at(0),{enqueueSnackbar:m}=(0,o.d)(),{spec:g,logger:p}=(0,l.r)(n.k,{data:{uri:e}});return{isPreSaved:d,addPresave:(0,i.useCallback)((async()=>{p.logInteraction(g.actionBarFactory().preSaveButtonFactory().hitPresave({prereleaseId:e,itemToBePresaved:e,contextUri:e})),await a(e),m(t?s.Ru.get("web-player.prerelease.audiobook_feedback_presaved"):s.Ru.get("web-player.prerelease.album_feedback_presaved"))}),[a,m,t,p,g,e]),removePresave:(0,i.useCallback)((async()=>{p.logInteraction(g.actionBarFactory().preSaveButtonFactory().hitRemovePresave({prereleaseId:e,itemToBeRemovedFromPresaved:e,contextUri:e})),await u(e)}),[p,u,g,e])}}},28480:(e,t,a)=>{a.d(t,{NowPlayingBar:()=>pn});var i=a(30758),n=a(97500),s=a.n(n),o=a(62411),r=a(94079),c=a(44040),l=a(98715),u=a(92574),d=a(17160);const m="dz_h98rH9nZCwfPdnKgr",g="rAfV2jB_HMM9Xtr0Rqvn",p="XkXPpDRWozMF6G8_GlLQ";var v=a(86070);const y=i.memo((function(e){const{handleClick:t}=e,a=d.Ru.get("pta.bottom-bar.title"),i=d.Ru.get("fta.bottom-bar.subtitle"),n=d.Ru.get("fta.sign-up-free");return(0,v.jsxs)("div",{className:m,onClick:t,"data-testid":"signup-bar",children:[(0,v.jsxs)("div",{className:g,children:[(0,v.jsx)(l.E,{as:"p",variant:"bodySmallBold",children:a}),(0,v.jsx)(l.E,{as:"p",variant:"bodyMedium",dangerouslySetInnerHTML:{__html:i}})]}),(0,v.jsx)(u.$,{colorSet:"invertedLight",onClick:t,className:p,children:n})]})}));var b=a(73328),h=a(73547),x=a(30934),k=a(35185),N=a(67766),C=a(8103),f=a(54191),j=a(47900);const I="gqYYMz8DkhaT3e44LcHQ",S="VX33mI2V_jRA7hRBI9_0",A=({remoteDeviceName:e,remoteDeviceType:t,connectionStatus:a,omitConnectionStateText:i=!1})=>{const{spec:n,logger:s}=(0,j.r)(x.s,{}),{triggerRef:o,toggleDevicePicker:r,isPickerOpen:c}=(0,N.z)(),u=(0,C.$A)(t,a),m=a===f.zP.CONNECTED?d.Ru.get("web-player.connect.bar.connected-state",{device_name:e}):d.Ru.get("web-player.connect.bar.connecting-state",{device_name:e});return(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)(u,{size:"small",className:S,role:"presentation",semanticColor:"essentialBase"}),(0,v.jsx)(h.Y,{component:"button",onClick:()=>{const e=n.activeDeviceButtonFactory(),{interactionId:t}=s.logInteraction(c?e.hitUiHide():e.hitUiReveal()),a=c;r(t),a||(0,k.I)("DEVICE-PICKER")},ref:o,className:I,children:(0,v.jsx)(l.E,{variant:"bodySmallBold","aria-live":"polite",semanticColor:"textBase",children:i&&a===f.zP.CONNECTED?e:m})})]})},P="nQSM_BrSHJ4Cp3XSuLOF",w=()=>(0,v.jsxs)("svg",{width:"1",height:"16",viewBox:"0 0 1 16",fill:"none",xmlns:"http://www.w3.org/2000/svg",role:"separator",className:P,children:[(0,v.jsx)("g",{id:"separator",clipPath:"url(#clip0_491_88335)",children:(0,v.jsx)("rect",{id:"Rectangle 111112858",width:"1",height:"16",rx:"0.5",fill:"var(--essential-base)"})}),(0,v.jsx)("defs",{children:(0,v.jsx)("clipPath",{id:"clip0_491_88335",children:(0,v.jsx)("rect",{width:"1",height:"16",fill:"white"})})})]});var D=a(83784),T=a(48260),E=a(56806),R=a(20039),B=a(68871);const L="main-connectBar-connectBar",O="main-connectBar-connected",_="main-connectBar-connecting",F=function(){const{isPlayingRemotely:e,connectionStatus:t,remoteDeviceName:a,remoteDeviceType:i}=(0,E.v)((e=>{const t=(0,T.V)(e);return{isPlayingRemotely:t.isPlayingRemotely,connectionStatus:t.connectionStatus,remoteDeviceName:t.remoteDevice?.name,remoteDeviceType:t.remoteDevice?.type}}),B.a),{currentSession:n}=(0,R.D)(),o=Boolean(n?.active),r=e&&a&&i;if(!r&&!o)return null;const c=t===f.zP.CONNECTED||o,l=t===f.zP.CONNECTING&&!o;return(0,v.jsxs)("div",{className:s()(L,{"encore-bright-accent-set":c,[O]:c,[_]:l}),children:[o&&(0,v.jsx)(D.K,{}),o&&r&&(0,v.jsx)(w,{}),r&&(0,v.jsx)(A,{connectionStatus:t,remoteDeviceName:a,remoteDeviceType:i,omitConnectionStateText:o})]})},U=()=>(0,v.jsx)(i.Suspense,{fallback:null,children:(0,v.jsx)(F,{})});var M=a(63922),V=a(27966),z=a(93805),G=a(80631),Q=a(77305),K=a(75028),q=a(84541),H=a(39750);var Y=a(40638),W=a(33100),Z=a(29462),X=a(65668),J=a(25748),$=a(60363);const ee="main-genericButton-button",te="main-genericButton-buttonActive",ae="main-genericButton-buttonActiveDot",ie=(0,i.forwardRef)(((e,t)=>{const a=e.isActive??!1,i=s()(ee,{[te]:a||e.isActiveNoIndicator,[ae]:a},e.className);return(0,v.jsx)($.Zp,{label:e.label,children:(0,v.jsx)(J.H,{ref:t,style:e.style,"aria-label":e.label,size:"small",className:i,disabled:e.disabled,iconOnly:e.icon,onClick:e.onToggle,"data-testid":e.testId,"data-active":a.toString(),"aria-pressed":a,"data-restore-focus-key":e.restoreFocusKey})})}));var ne=a(94875),se=a(11727),oe=a(80381);const re=({className:e="",disabledClassName:t="",onClick:a})=>{const n=(0,X.lZ)(),o=(0,H.o)((e=>e?.hasContext??!1)),r=(0,V.l)(),c=!o,{toggleFullScreen:l,isInFullScreen:u}=(0,oe.H)({refOrElement:document.body,shouldWakeLockScreen:!0}),m=(0,i.useCallback)((()=>{const e=u?M.z.CLOSED:M.z.NOW_PLAYING_VIEW;l(),setTimeout((()=>{r(e)}),1)}),[u,r,l]),g=(0,i.useCallback)((async()=>{o&&(a?.(!0),m())}),[o,a,m]),p=u?ne.z:se.T,y=u?d.Ru.get("web-player.cinema-mode.fullscreen.exit"):d.Ru.get("web-player.cinema-mode.fullscreen.enter"),b=s()(e,{[t]:c});return n?(0,v.jsx)(ie,{onToggle:g,className:b,icon:p,label:y,disabled:c,testId:"fullscreen-mode-button"}):null},ce=(0,i.memo)(re);var le=a(35188),ue=a(80360),de=a(95140);var me=a(28518),ge=a(23806);const pe="xP7v0EBcbJMj1xIJxywg",ve="zJU_lLLzQL6oKvMA0c5b",ye=({onClose:e,onMouseEnter:t,onMouseLeave:a,onClick:i,impressionCallback:n,message:s})=>(0,v.jsxs)("div",{className:pe,onMouseEnter:t,onMouseLeave:a,ref:n,onClick:i,children:[(0,v.jsx)(l.E,{id:"nudgeBody",as:"p",variant:"bodyMedium",semanticColor:"textBase",children:s}),(0,v.jsx)(J.H,{iconOnly:ge.M,size:"small",semanticColor:"textBase",onClick:t=>{t.stopPropagation(),e?.()},"aria-label":d.Ru.get("close"),className:ve})]});var be=a(68895),he=a(78682);const xe=(e=be.C)=>{const t=(0,o.Pj)(),{isActive:a}=e(),i=(0,he.h)();return document.hasFocus()&&!a&&!(({ui:e,ads:t},a)=>e.blockUserDialog.isOpen||e.connectDevicePicker.isOpen||e.deleteFolderDialog.isOpen||e.deletePlaylistDialog.isOpen||e.fullscreenMode.isOpen||e.improvedSignupPromptDialog.isOpen||e.keyboardShortcutsHelpModal.isOpen||e.leavePlaylistDialog.isOpen||e.offlineDeviceLimitReachedDialog.isOpen||e.playbackNotSupportedErrorDialog.isOpen||e.premiumDialog.isOpen||!0===t.billboard?.isOpen&&!t.billboard.isMinimized||!1===t.vto?.isHidden&&!1===t.vto?.isMinimized||a)(t.getState(),i.current.length>0)};var ke=a(44314);var Ne=a(70397),Ce=a(95702),fe=a(53551),je=a(96861),Ie=a(97959),Se=a(63951),Ae=a(30752),Pe=a(70650);const we=e=>{const t=(0,i.useRef)(),a=(0,i.useRef)(),n=(0,i.useRef)(!1),s=(0,Ie.z)(),o=(0,Ce.Z)(),{spec:r,logger:c}=(0,j.r)(ke.w,{}),l=(0,i.useRef)(null),u=(0,i.useCallback)((()=>{c.logInteraction(r.djVoiceUnsupportedNudgeFactory().closeButtonFactory().hitUiHide())}),[r,c]),m=(0,i.useCallback)((e=>{e&&l.current!==e&&c.logImpression(r.djVoiceUnsupportedNudgeFactory().impression()),l.current=e}),[r,c]),g=(0,i.useCallback)((()=>{const e=s.getState(),t=o.getActiveDevice();return!(e=>e?.isLocal??!1)(t)&&(0,Pe.yc)(e,"spotify:playlist:37i9dQZF1EYkqdzj48dyYq")!==Ae.i.NOT_ACTIVE&&!(e=>Boolean(e?.supportsDJNarration))(t??void 0)}),[s,o]),p=(0,i.useCallback)((()=>{g()&&e({nudgeType:"message-only-nudge",message:d.Ru.get("web-player.connect.nudge.dj-voice-unavailable"),onClose:u,impressionCallback:m})}),[e,g,u,m]),v=(0,i.useCallback)((e=>{e.data.action===je.Ik.PLAY&&(n.current=!0)}),[]);(0,Se.p)(je.gd.ACTION,v);const y=(0,i.useCallback)((e=>{n.current&&(0,Pe.uW)(e.data)===Ae.i.PLAYING&&(t.current=e.data?.context.uri,p(),t.current=void 0,n.current=!1)}),[p]);(0,Se.p)(je.gd.UPDATE,y);const b=(0,i.useCallback)((e=>{const t=e.data?.activeDevice;t&&!t.isLocal&&a.current!==t.connectStateId&&p(),a.current=t?.connectStateId}),[p]);(0,fe.W)(Ne.P.UPDATE,b)};var De=a(43584);const Te=e=>e.some((e=>e.isLocalNetwork&&!e.isDisabled&&(e=>{switch(e.type){case f.bq.AUDIO_DONGLE:case f.bq.AVR:case f.bq.CAST_AUDIO:case f.bq.CAST_VIDEO:case f.bq.GAME_CONSOLE:case f.bq.SPEAKER:case f.bq.STB:case f.bq.TV:return!0;default:return!1}})(e)));var Ee=a(4511),Re=a(52831),Be=a(96258);const Le=new Date(0).toISOString(),Oe=["shift+alt+f10"],_e=e=>{const t=(0,i.useRef)(),a=(0,i.useRef)(!1),n=(0,i.useRef)(!1),s=(0,o.Pj)(),r=(0,Ie.z)(),c=(0,Ce.Z)(),l=(0,Re.V)(),[u,m]=(0,Be.x)("connect-nudge-triggered-at",Le),g=(0,i.useRef)(null),{spec:p,logger:v}=(0,j.r)(ke.w,{}),y=(0,i.useCallback)((()=>{v.logInteraction(p.connectFromDevicePickerNudgeFactory().hitNoAction())}),[p,v]),b=(0,i.useCallback)((()=>{v.logInteraction(p.connectFromDevicePickerNudgeFactory().closeButtonFactory().hitUiHide())}),[p,v]),h=(0,i.useCallback)((e=>{e&&g.current!==e&&v.logImpression(p.connectFromDevicePickerNudgeFactory().impression()),g.current=e}),[p,v]);(0,Ee.f)(Oe,(async()=>{const{platform:{isDeveloperMode:e}}=s.getState();if(e){const e=new Date;e.setHours(e.getHours()-8),m(e.toISOString())}}));const x=(0,i.useCallback)((()=>{const e=r.getState(),t=c.getActiveDevice(),a=c.getDevices(),i=l.getDefaultDevice(),n=new Date(u);n.setHours(n.getHours()+8);return n<=new Date&&(e=>e?.isLocal??!1)(t)&&!(0,Pe.A3)(e)&&Te(a)&&(e=>!e||!(e.terminalType===De.FI.HEADPHONES||e.terminalType===De.FI.SPEAKERS&&(e.transportType===De.Yg.BLUETOOTH||e.transportType===De.Yg.USB)))(i)}),[r,l,u,c]),k=(0,i.useCallback)((()=>{if(x()){e({nudgeType:"message-only-nudge",message:d.Ru.get("web-player.connect.nudge.listen-to-speaker"),impressionCallback:h,onClick:y,onClose:b});const t=(new Date).toISOString();m(t)}}),[e,x,m,y,b,h]),N=(0,i.useCallback)((e=>{e.data.action===je.Ik.PLAY?a.current=!0:e.data.action===je.Ik.RESUME&&(n.current=!0)}),[]);(0,Se.p)(je.gd.ACTION,N);const C=(0,i.useCallback)((e=>{a.current&&(0,Pe.uW)(e.data)===Ae.i.PLAYING?(t.current=e.data?.context.uri,k(),t.current=void 0,a.current=!1):n.current&&!1===e.data?.isPaused&&(t.current=e.data?.context.uri,k(),t.current=void 0,n.current=!1)}),[k]);(0,Se.p)(je.gd.UPDATE,C)},Fe=e=>{_e(e),we(e)};var Ue=a(96422);const Me=()=>{const e=(0,i.useRef)(),t=(0,i.useRef)(!1),a=(0,i.useRef)(!1),n=(0,o.wA)(),s=(0,o.d4)((e=>e.ui.connectNudge.isOpen)),r=(0,o.d4)((e=>e.ui.connectDevicePicker.isOpen)),c=(0,i.useCallback)((()=>{a.current&&(clearTimeout(e.current),a.current=!1),n((0,Ue.Yp)())}),[n]),l=(0,i.useCallback)((()=>{a.current=!1,t.current||c()}),[c]),u=(0,i.useCallback)((()=>{e.current=window.setTimeout(l,8e3),n((0,Ue.dK)()),a.current=!0}),[n,l]),d=(0,i.useCallback)((e=>{t.current=e,e||a.current||c()}),[c]);return(0,i.useEffect)((()=>{r&&c()}),[r,c]),(0,i.useMemo)((()=>({hideNudge:c,showNudge:u,setShouldKeepShowingNudge:d,isNudgeVisible:s})),[c,u,d,s])},Ve=({children:e,useNudgeTriggers:t=Fe,useToggleNudgeWithTimer:a=Me,useCanShowNudge:n=xe,disabled:s=!1})=>{const{showNudge:o,hideNudge:r,setShouldKeepShowingNudge:c,isNudgeVisible:l}=a(),[u,d]=(0,i.useState)(null),m=n();(0,i.useEffect)((()=>{l&&!m&&r()}),[m,r,l]),t((e=>!(l||!m)&&(d(e),o(),!0)));const g=(0,i.useCallback)((e=>{if(!e)return(0,v.jsx)(v.Fragment,{});return(0,v.jsx)(ye,{onMouseEnter:()=>c(!0),onMouseLeave:()=>c(!1),...e,onClose:()=>{e?.onClose?.(),r()}})}),[r,c]);return(0,v.jsx)(me.W,{placement:"top",visible:Boolean(u?.message)&&l&&!s,overlay:g(u),popperOptions:{modifiers:[{name:"preventOverflow",options:{rootBoundary:"viewport",altAxis:!0,padding:24,tether:!1}}]},onHide:()=>{},fadeOut:!0,useLazyMounting:!0,children:e})};var ze=a(84809),Ge=a(42919),Qe=a(92180);const Ke=()=>{const{remoteDeviceType:e,remoteDeviceIsGroup:t,connectionStatus:a}=(0,E.v)((e=>{const t=(0,T.V)(e);return{remoteDeviceType:t.remoteDevice?.type,remoteDeviceIsGroup:t.remoteDevice?.isGroup,connectionStatus:t.connectionStatus}}),B.a),n=(0,ue.g)(),{isActive:s}=(0,ze.AI)(Ge.Z.DevicePickerOverlay),{canTogglePanel:o,isActive:r,togglePanel:c}=(0,de.C)(),{spec:l,logger:u}=(0,j.r)(le.p,{}),m=(0,i.useCallback)((()=>{const{interactionId:e}=u.logInteraction(function(e,t,a){return {interactionId:null,pageInstanceId:null};let i;return i=t===f.zP.CONNECTING?e.connectingButtonFactory():t===f.zP.CONNECTED?e.connectedButtonFactory():e.notConnectedButtonFactory(),a?i.hitUiHide():i.hitUiReveal()}(l,a,r));c(e)}),[a,c,r,l,u]),{currentDevice:g}=(0,Qe.l)(),{isLocal:p}=g,y=(0,i.useMemo)((()=>(0,C.tf)(e,t,p?n:null)),[n,p,t,e]);return(0,v.jsx)(Ve,{children:(0,v.jsx)(ie,{isActive:r,disabled:!o,onToggle:m,label:d.Ru.get("playback-control.connect-picker"),icon:y,restoreFocusKey:s?Ge.Z.DevicePickerOverlay:Ge.Z.DevicePicker})})};var qe=a(4394),He=a(90515),Ye=a(18386),We=a(2298);const Ze=He.$S.PUFFIN_BUTTON_CLICK,Xe=He.$S.DEVICE_PICKER_BUTTON_CLICK,Je=()=>{const{isPuffinPanelActive:e}=(0,We.c)(),{isActive:t,panelSend:a}=(0,ze.AI)(Ge.Z.DevicePicker,Ge.Z.DevicePickerOverlay),n=(0,ze.Ev)(Ze),{remoteDeviceType:s,remoteDeviceisGroup:o}=(0,E.v)((e=>{const t=(0,T.V)(e);return{remoteDeviceType:t.remoteDevice?.type,remoteDeviceisGroup:t.remoteDevice?.isGroup}}),B.a),r=(0,ue.g)(),c=r?.audioDevice.terminalType===De.FI.HEADPHONES,l=(0,Ye.K)(),u=t||e,m=l||c,{currentDevice:g}=(0,Qe.l)(),{isLocal:p}=g,y=(0,i.useMemo)((()=>l?qe.C:(0,C.tf)(s,o,p?r:null)),[r,l,o,s,p]);return(0,v.jsx)(ie,{isActive:u,isActiveNoIndicator:m,onToggle:()=>{const e=t;a(Xe),e||(0,k.I)("DEVICE-PICKER")},label:d.Ru.get("playback-control.connect-picker"),icon:y,disabled:!n,restoreFocusKey:e?Ge.Z.Puffin:Ge.Z.DevicePicker})};var $e=a(67407);const et=()=>{const{isAnonymous:e}=(0,o.d4)(K.Ht),t=(0,$e.v)();return e?null:t?(0,v.jsx)(i.Suspense,{fallback:null,children:(0,v.jsx)(Je,{})}):(0,v.jsx)(Ke,{})};var tt=a(71752),at=a(6068),it=a(64871),nt=a(41238),st=a(34542),ot=a(72642),rt=a(72540);const ct=i.memo((({onClick:e,className:t,isActive:a,isEnabled:i})=>{const n=i?d.Ru.get("web-player.lyrics.title"):d.Ru.get("web-player.lyrics.noLyrics1"),s=i?e:void 0;return(0,v.jsx)(ie,{className:t,isActive:a,onToggle:s,disabled:!i,label:n,testId:"lyrics-button",icon:at.q})})),lt=i.memo((e=>{const t=Boolean((0,ot.J)().data?.hasLyrics);return(0,v.jsx)(ct,{...e,isEnabled:t,isActive:!1})})),ut=i.memo((e=>{const t=(0,H.o)((e=>e?.item?.uri)),a=Boolean((0,st.f)(t).hasLyrics);return(0,v.jsx)(ct,{...e,isEnabled:a,isActive:!1})})),dt=i.memo((e=>{const t=(0,z.S)(),{currentVariant:a}=(0,G.r)(),{isActiveNotCinemaMode:i}=(0,nt.$)(),{isAnonymous:n}=(0,o.d4)(K.Ht),s=(0,W.NC)(rt.khs),r=(0,H.o)((e=>{if(e?.item?.uri&&(0,it.U_m)(e?.item?.uri)){return!Boolean(e?.item?.metadata?.["segment.index"])}return!1}));if(n||!r)return null;const c=t===M.z.NOW_PLAYING_VIEW&&"lyrics"===a,l=i||c;return l?(0,v.jsx)(ct,{...e,isActive:l,isEnabled:!0}):s?(0,v.jsx)(lt,{...e}):(0,v.jsx)(ut,{...e})}));var mt=a(85387),gt=a(77936),pt=a(30188),vt=a(45111),yt=a(89471);const bt=({onClick:e,className:t})=>{const a=(0,z.S)(),{currentVariant:i,previousVariant:n}=(0,G.r)(),s=(0,tt.F)(),{toggleLyrics:o}=function({referrer:e,onChange:t}){const a=(0,mt.Zp)(),{isActive:i,routeDestination:n}=(0,nt.$)(),{setVideoPlayerUIFlag:s}=(0,gt.d)(),o=(0,yt.f)(),r=()=>{i||(s(pt.nP.cinemaLegacy,!1),a(n,{state:{referrer:e}}),t?.(n))},c=()=>{if(i){const e="/",i=o.uri===vt.N6?e:(0,it.o_h)(o.uri)?.toURLPath(!0)??e;a(i),t?.(null)}};return{isActive:i,showLyrics:r,hideLyrics:c,toggleLyrics:()=>{i?c():r()}}}({onChange:e,referrer:"now_playing_bar"}),r=a===M.z.NOW_PLAYING_VIEW;return(0,v.jsx)(dt,{onClick:r?()=>{s("lyrics"===i?n??"artwork":"lyrics")}:o,className:t})};var ht=a(51689);const xt=He.$S.NPV_BUTTON_CLICK,kt=({onClick:e})=>{const{isActive:t,panelSend:a}=(0,ze.AI)(Ge.Z.NowPlayingView),i=(0,ze.Ev)(xt),{mode:n,setMode:s}=(0,Q.r)(),o=(0,W.NC)(rt.ZDY),r=(0,z.S)(),c=(0,V.l)(),{item:l}=(0,H.o)((e=>({item:e?.item})),((e,t)=>e.item?.uri===t.item?.uri)),u=!l||!i,m=r===M.z.NOW_PLAYING_VIEW;if(o)return null;const g=t&&!m;return(0,v.jsx)(ie,{isActive:g,disabled:u,onToggle:()=>{e?.(!t),m?((0,k.I)("NPV_OPEN_CINEMA_MODE_BUTTON"),c(M.z.CLOSED),t||a(xt)):a(xt),n===q.YU.cinema&&s(q.YU.npv)},icon:ht.d,label:d.Ru.get("web-player.now-playing-view.label"),testId:"control-button-npv",restoreFocusKey:Ge.Z.NowPlayingView})};var Nt=a(30771),Ct=a(31371),ft=a(8186),jt=a(59682),It=a(89137),St=a(15917),At=a(27649);const Pt=({uri:e,to:t,children:a,onDrop:n,onNavigate:s,className:r})=>{const[c,l]=(0,i.useState)(!1),u=(0,i.useRef)(null),d=(0,It.g)(),m=(0,o.wA)(),g=(0,St.f)(),p=(0,At.g)(),y=(0,Ie.z)(),b=function(e){const t=(0,it.o_h)(e),a=(0,o.d4)(K.F6);switch(t?.type){case it.NQG.PLAYLIST:case it.NQG.PLAYLIST_V2:{let e;if((0,it.iwx)(t)&&(e=t.username),a&&e===a)return[jt.Ay[it.NQG.TRACK],jt.Ay[it.NQG.LOCAL],jt.Ay[it.NQG.ALBUM]];break}case it.NQG.COLLECTION:return[jt.Ay[it.NQG.TRACK],jt.Ay[it.NQG.ALBUM],jt.Ay[it.NQG.ARTIST],jt.Ay[it.NQG.PLAYLIST],jt.Ay[it.NQG.PLAYLIST_V2],jt.Ay[it.NQG.SHOW]];case it.NQG.QUEUE:return[jt.Ay[it.NQG.TRACK],jt.Ay[it.NQG.LOCAL],jt.Ay[it.NQG.EPISODE]];default:return[]}return[]}(e),h=!!b.length;return(0,i.useEffect)((()=>(c?u.current=window.setTimeout((()=>{(0,it.U_m)(e)||(s?.(),d(t||(0,it.o_h)(e).toURLPath(!0)))}),1e3):!c&&u.current&&clearTimeout(u.current),()=>{u.current&&clearTimeout(u.current)})),[c,e,t,s,d]),h?(0,v.jsx)(ft.A,{types:b,onDrop:t=>{const a=(0,it.o_h)(e),i=Array.from(t.dataTransfer.types).find((e=>b.includes(e))),s=i&&t.dataTransfer.getData(i),o=s&&s.split("\n")[0],r=(0,it.o_h)(o);if(r&&a)switch(n?.(r.toURI()),a.type){case it.NQG.PLAYLIST:case it.NQG.PLAYLIST_V2:m((0,Ct.io)(e,[r.toURI()]));break;case it.NQG.COLLECTION:(0,it._Tv)(r)||(0,it.ecE)(r)||(0,it.U_m)(r)?g.add({uris:[r.toURI()]}):(0,it.tbX)(r)?p.add([r.toURI()],{before:"start"}):(0,it.WB1)(r)&&g.add({uris:[r.toURI()]});break;case it.NQG.QUEUE:y.addToQueue([{uri:r.toURI(),uid:null}])}},onDragEnter:()=>{l(!0)},onDragLeave:()=>{l(!1)},className:r,children:a}):(0,v.jsx)("div",{children:a})};var wt=a(62287);const Dt=He.$S.QUEUE_BUTTON_CLICK,Tt=({onClick:e})=>{const{isEnabled:t,isVisible:a}=(()=>{const{isAnonymous:e}=(0,o.d4)(K.Ht),{videoPlayerMode:t}=(0,gt.d)();return e||t===pt.Kz.cinemaLegacy?{isVisible:!1}:{isVisible:!0,isEnabled:!0}})(),n=(0,ze.Ev)(Dt),{isActive:s}=(0,ze.AI)(Ge.Z.Queue,Ge.Z.QueueOverlay),{toggleQueue:r}=(0,wt.R)(),c=(0,i.useCallback)((()=>{t&&(e({mode:"panel",aboutToShow:!s}),r())}),[t,e,s,r]);return a?(0,v.jsx)(Pt,{uri:"spotify:queue",children:(0,v.jsx)(ie,{icon:Nt.j,label:d.Ru.get("playback-control.queue"),onToggle:c,isActive:s,disabled:!t||!n,testId:"control-button-queue",restoreFocusKey:Ge.Z.Queue})}):null};var Et=a(37067),Rt=a(63696),Bt=a(40960);const Lt=({onClick:e})=>{const{item:t}=(0,Rt.L)()??{},{isActive:a,onClick:i,showButton:n}=(0,Bt.D)({item:t,onClick:e});return t&&n?(0,v.jsx)(ie,{isActive:a,onToggle:i,label:a?d.Ru.get("miniplayer.close"):d.Ru.get("miniplayer.open"),icon:Et.F,testId:"pip-toggle-button"}):null};var Ot=a(38401),_t=a(79902);const Ft="main-nowPlayingBar-extraControls",Ut="main-nowPlayingBar-lyricsButton",Mt="main-nowPlayingBar-volumeBar",Vt=()=>{const e=(0,W.NC)(rt.L$q),{setVideoPlayerUIFlag:t,videoPlayerMode:a}=(0,gt.d)(),{spec:n,logger:s,UBIFragment:o}=(0,j.r)(Z.h9,{data:{identifier:a===pt.Kz.cinemaLegacy?Z.gw.CINEMA:Z.gw.DESKTOP}}),r=(0,Y.YQ)((e=>{s.logInteraction(n.volumeBarFactory().dragSetVolume({newVolumePercentage:Math.floor(100*e)}))}),500,{leading:!1,trailing:!0}),c=(0,i.useCallback)((e=>{e&&t(pt.nP.cinemaLegacy,!1)}),[t]);return(0,v.jsx)(o,{spec:n,children:(0,v.jsxs)("div",{className:Ft,children:[(0,v.jsx)(_t.mA,{onClick:()=>{s.logInteraction(n.djJumpButtonFactory().hitRefreshContent())}}),(0,v.jsx)(kt,{onClick:e=>{e?s.logInteraction(n.npvButtonFactory().hitUiReveal()):s.logInteraction(n.npvButtonFactory().hitUiHide())}}),e===rt.vkU.CONTROL&&(0,v.jsx)(bt,{className:Ut,onClick:e=>{e?s.logInteraction(n.lyricsButtonFactory().hitUiNavigate({destination:e})):s.logInteraction(n.lyricsButtonFactory().hitUiNavigateBack())}}),(0,v.jsx)(Tt,{onClick:e=>{"main"===e.mode?e.route?s.logInteraction(n.queueButtonFactory().hitUiNavigate({destination:e.route})):s.logInteraction(n.queueButtonFactory().hitUiNavigateBack()):e.aboutToShow?s.logInteraction(n.queueButtonFactory().hitUiReveal()):s.logInteraction(n.queueButtonFactory().hitUiHide())}}),(0,v.jsx)(et,{}),(0,v.jsx)(Ot.M,{className:Mt,onVolumeBarClick:e=>{s.logInteraction(n.volumeBarFactory().hitSetVolume({newVolumePercentage:Math.floor(100*e)}))},onToggleMuteClick:e=>{"muted"===e?s.logInteraction(n.volumeMuteButtonFactory().hitMutePlayback()):"not_muted"===e&&s.logInteraction(n.volumeMuteButtonFactory().hitUnmutePlayback())},onVolumeBarDrag:r}),(0,v.jsx)(Lt,{onClick:c}),(0,v.jsx)(ce,{className:"control-button",disabledClassName:"control-button--disabled",onClick:e=>{e&&s.logInteraction(n.fullscreenButtonFactory().hitUiReveal())}})]})})};var zt=a(39708),Gt=a(89557),Qt=a(26062);const Kt="yyrJTUPMeLS8qs1a0YJr",qt=({logoUrl:e})=>e?(0,v.jsx)("div",{className:Kt,"data-testid":"context-ad-logo",children:(0,v.jsx)(Gt.N,{loading:"eager",imgSrc:e,width:56,height:56,type:Qt.c.AD})}):null;var Ht=a(20421),Yt=a(64647),Wt=a(85847);const Zt=({item:e,context:t,index:a})=>{const{logoImage:i}=(0,Ht.b)(e);return(0,v.jsx)(Wt.e,{item:e,context:t,index:a,"aria-label":d.Ru.get("ad-formats.advertisement"),adEventReason:Yt.c.AD_LOGO,isVisible:!1,children:(0,v.jsx)(qt,{logoUrl:i})})};var Xt=a(73765),Jt=a(41170),$t=a(82936);const ea=i.memo((function({uri:e,className:t,onClick:a,size:n=Xt.t.xs}){const[s,o]=(0,$t.A)(e),r=(0,Jt.W)(),c=(0,i.useCallback)((t=>{t.preventDefault(),r({targetUri:e,intent:s?"remove-from-library":"add-to-library",type:"click"}),a&&a(!s),o(!s)}),[r,e,s,a,o]);return(0,v.jsx)(Xt.M,{className:t,size:n,onClick:c,isAdded:!!s,condensed:!0})}));var ta=a(84371),aa=a(14033),ia=a(26090);const na=({uri:e,isBook:t=!1,size:a=Xt.t.xs,className:n,onClick:s})=>{const{isPreSaved:o,addPresave:r,removePresave:c}=(0,ia.w)({uri:e,isBook:t}),l=(0,i.useCallback)((()=>{o?c():r(),s?.(!o)}),[o,s,c,r]);return(0,v.jsx)(Xt.M,{className:n,size:a,onClick:l,isAdded:!!o,condensed:!0})};var sa=a(52945),oa=a(22619),ra=a(40601),ca=a(67529),la=a(67785),ua=a(24258),da=a(39774),ma=a(37e3),ga=a(77786),pa=a(68740),va=a(25882);function ya(e){return(0,va.v)(e)||(0,pa.p)(e)}const ba=He.$S.NPV_BUTTON_CLICK,ha=()=>{const e=(0,V.l)(),t=(0,W.NC)(rt.wZE),a=(0,z.S)(),n=(0,ze._Y)();return(0,i.useCallback)((()=>{a===M.z.CLOSED?t?e(M.z.NOW_PLAYING_VIEW):n(ba):e(M.z.CLOSED)}),[t,a,n,e])};var xa=a(7545),ka=a(83898),Na=a(38684);const Ca="main-nowPlayingWidget-nowPlaying",fa="ZbFkATBbLkWh2SHMXDt6",ja="main-coverSlotCollapsed-navAltContainer",Ia="main-nowPlayingWidget-coverArt",Sa="main-nowPlayingWidget-trackInfo",Aa="HD9s7U5E1RLSWKpXmrqx",Pa=({spec:e})=>{const t=(0,Na.s)(),a=(0,Rt.L)(),{draggable:n,onDragStart:s}=(0,ka.P)(),o=(0,z.S)(),r=ha(),{images:c}=(0,xa.u)(a?.item),l=o===M.z.NOW_PLAYING_VIEW,u=(0,i.useCallback)((()=>{r();const a=l?e.hitUiHide():e.hitUiReveal();t.logInteraction(a)}),[l,t,e,r]);if(null===a)return null;const{context:m,item:g}=a;return(0,v.jsx)(la.h,{menu:(0,v.jsx)(da.W,{context:m,item:g}),children:(0,v.jsx)("div",{draggable:n&&ya(g),onDragStart:e=>{s(e,{itemUris:[g.uri],dragLabelText:(0,ga.r)(g)})},children:(0,v.jsx)(ma.R,{uri:m.uri,owner:m.metadata?.context_owner,children:(0,v.jsx)("button",{type:"button","data-testid":"cover-art-button",className:Aa,"aria-label":d.Ru.get("web-player.now-playing-view.label"),onClick:u,children:(0,v.jsx)(ua.b,{images:c,type:g.type,size:56,maxSize:56,className:Ia})})})})})};var wa=a(81940),Da=a(17699),Ta=a(92783),Ea=a(70836);const Ra="main-coverSlotCollapsed-container",Ba="main-coverSlotCollapsed-expandButton",La=He.$S.NPV_BUTTON_CLICK,Oa=({children:e,className:t,spec:a})=>{const n=(0,Na.s)(),o=(0,ze.Ev)(La),r=(0,z.S)(),{isActive:c}=(0,ze.AI)(Ge.Z.NowPlayingView),l=(0,W.NC)(rt.wZE),u=ha(),m=(0,i.useMemo)((()=>{if(l){const e=r===M.z.NOW_PLAYING_VIEW;return{label:e?d.Ru.get("web-player.cinema-mode.minimize"):d.Ru.get("web-player.now-playing-view.cinema-mode.expand"),Icon:e?wa.b:Da.L,isActive:e,isDisabled:!1}}return{label:c?d.Ru.get("npb.collapseCoverArt"):d.Ru.get("npb.expandCoverArt"),Icon:c?Ta.r:Ea.o,isActive:c,isDisabled:!o}}),[l,o,r,c]),g=(0,i.useCallback)((()=>{u();const e=a.coverartArrowFactory(),t=m.isActive?e.hitUiHide():e.hitUiReveal();n.logInteraction(t)}),[n,a,m.isActive,u]);return(0,v.jsxs)("div",{"data-testid":"CoverSlotCollapsed__container",className:s()(Ra,t),children:[e,(0,v.jsx)($.Zp,{label:m.label,children:(0,v.jsx)("button",{className:s()(Ba),disabled:m.isDisabled,onClick:g,"aria-label":m.label,"aria-pressed":m.isActive,children:(0,v.jsx)(m.Icon,{iconSize:16})})})]})};var _a=a(91330),Fa=a(10106),Ua=a(91437);var Ma=a(13677),Va=a(44754),za=a(82747),Ga=a(12566),Qa=a(54e3),Ka=a(17824),qa=a(87606),Ha=a(5408),Ya=a(17554);const Wa=({context:e,item:t,onLike:a})=>{const i=(0,Ga.X)(),n=(0,za.C)(),s=(0,oa.v)(t);if(i&&n&&(0,Va.N)(t))return(0,v.jsx)(Ma.o,{contextUri:t.metadata?.context_uri??e.uri,id:t.uid??void 0,uri:t.uri,isActive:!0});if(s)return(0,v.jsx)(sa.g,{uri:t.uri,condensed:!0});if((0,va.v)(t))return t.isLocal?null:(0,v.jsx)(aa.b,{uri:t.uri,className:"control-button control-button-heart",onClick:a});if((0,pa.p)(t))return(0,v.jsx)(ta.b,{condensed:!0,uri:t.uri,className:"control-button control-button-heart",onClick:a});if((0,Ka.d)(t)){return"trailer"===t?.metadata?.type&&"true"===t?.metadata?.is_pre_release?(0,v.jsx)(na,{uri:t.book.uri,isBook:!0,className:"control-button control-button-heart",onClick:a}):(0,v.jsx)(ea,{uri:t.book.uri,className:"control-button control-button-heart",onClick:a})}return(0,Qa.N)(t)||(0,qa.v)(t)?null:(0,Ya.d)(t)},Za=({state:{item:e,context:t,index:a}})=>{!function(e){const t=(0,Ua.i)(),a=(0,Fa.X)(e);(0,i.useEffect)((()=>{a&&t.say(a)}),[a,t])}(e);const{videoPlayerMode:n,setVideoPlayerUIFlag:s}=(0,gt.d)(),{spec:o,logger:r}=(0,j.r)(zt.p6,{data:{identifier:n===pt.Kz.cinemaLegacy?zt.gw.CINEMA:zt.gw.DESKTOP}}),c=(0,Fa.P)(e),l=(0,W.NC)(rt.WAA);(0,i.useEffect)((()=>{s(pt.nP.nowPlayingBar,l)}),[l,s]);const u=n===pt.Kz.nowPlayingBar&&l,d=(0,i.useMemo)((()=>o.coverartFactory({uri:e.uri})),[e.uri,o]);return(0,v.jsx)(i.Suspense,{fallback:null,children:(0,v.jsx)("div",{"data-testid":"now-playing-widget",className:Ca,role:"contentinfo","aria-label":c,children:(0,v.jsxs)(Ha.r,{spec:o,children:[(0,Qa.N)(e)?(0,v.jsx)(Zt,{item:e,context:t,index:a}):(0,v.jsxs)(Oa,{className:ja,spec:d,children:[!u&&(0,v.jsx)(Pa,{spec:d}),l&&(0,v.jsx)("div",{id:"VideoPlayerNpb_ReactPortal"})]}),(0,v.jsx)(ra.d,{context:t,className:Sa,item:e,size:"xsmall",enableVideoButton:!0,onTitleClick:t=>{r.logInteraction(o.titleFactory({uri:e.uri}).hitUiNavigate({destination:t||""}))},onSubtitleClick:t=>{r.logInteraction(o.subtitleFactory({uri:e.uri}).hitUiNavigate({destination:t||""}))},referrer:ca.G.NPB}),(0,v.jsxs)("div",{className:fa,children:[(0,v.jsx)(_a.a,{context:t,item:e,onClick:()=>{r.logInteraction(o.hideButtonFactory().hitRemoveRecommendation({recommendedItemUri:e.uri,contextUri:t.uri}))}}),(0,v.jsx)(Wa,{item:e,onLike:t=>{r.logInteraction(t?o.likeButtonFactory({uri:e.uri}).hitLike({itemToBeLiked:e.uri}):o.likeButtonFactory({uri:e.uri}).hitRemoveLike({itemNoLongerLiked:e.uri}))},context:t})]})]})})})},Xa=()=>{const e=(0,Rt.L)();return null===e?(0,v.jsx)("div",{className:s()("now-playing")}):(0,v.jsx)(Za,{state:e})};var Ja=a(28109);const $a="aguQsGoZR9wZeawKGdDh",ei="ieqOSqJb6kk3bG5XDOHk",ti=({paused:e,fromSeconds:t})=>{const[a,n]=(0,i.useState)(t);return(0,Ja.$)((t=>{n((a=>e?a:a>0?a-1:(t(),a)))}),1e3),(0,v.jsxs)("div",{className:$a,children:[d.Ru.get("ad-formats.skippable_ads.skip_countdown"),(0,v.jsx)("span",{className:ei,children:a})]})};var ai=a(21810);const ii=({children:e})=>{const t=(0,H.o)((e=>e),((e,t)=>(0,B.a)(e?.restrictions,t?.restrictions)&&e?.item?.uri===t?.item?.uri&&e?.isPaused===t?.isPaused)),a=t?.restrictions.disallowSkippingNextReasons.includes("ad_disallow"),i=t?.isPaused??!1,n=(0,ai.qc)(t),s=(0,ai.Tv)(t),r=(0,o.d4)((e=>n?e?.ads?.audio?.info?.skippableAdDelaySeconds:s?e?.ads?.vto?.info?.skippableAdDelaySeconds:void 0));return a&&r?(0,v.jsx)(ti,{paused:!!i,fromSeconds:r}):(0,v.jsx)(v.Fragment,{children:e})};var ni=a(90238),si=a(66517);var oi=a(76546),ri=a(91064);const ci=e=>{const[t,a]=(0,i.useState)(new Map),[n,s]=(0,i.useState)(),o=(0,oi.L)(),r=(0,si.mr)(),{currentDevice:c}=(0,Qe.l)(),l=(0,ri.vh)(),u=(0,i.useCallback)((()=>{if(!e)return;const i=(({lastRecordedItem:e,setLastRecordedItem:t,recentAds:a,setRecentAds:i,playerStateItem:n,currentDevice:s})=>{let o={isMissingAdData:!1};if(n&&n.uri!==e?.uri){if(e?.type===Qt.c.AD){const t=e?.uri.split(":")[2];a.has(t)?i((e=>{const a=new Map(e);return a.delete(t),a})):o={isMissingAdData:!0,errorMessage:s.isLocal?"primary_device":"secondary_device",adId:t}}t((()=>n))}return o})({lastRecordedItem:n,setLastRecordedItem:s,recentAds:t,setRecentAds:a,playerStateItem:o?.item,currentDevice:c});if(i.isMissingAdData){const{errorMessage:e,adId:t}=i;l.send((0,ni.G)({error_type:"missing_ad_data",error_message:e,slot:"stream",ad_id:t}))}}),[o,n,t,l,c,e]),d=(0,i.useCallback)((()=>{e&&r&&a((e=>{let a=e;return t.has(r.adId)||(a=new Map(e).set(r.adId,r)),a}))}),[t,r,e]);(0,i.useEffect)((()=>{u()}),[u]),(0,i.useEffect)((()=>{d()}),[d])};var li=a(97342),ui=a(44330),di=a(93151),mi=a(45492),gi=a(67496),pi=a(32330),vi=a(79318),yi=a(25186),bi=a(13436),hi=a(54434);const xi="player-controls",ki="player-controls__buttons",Ni="player-controls__left",Ci="player-controls__right",fi=(0,i.memo)((function({item:e}){const t=mi.Q.isPodcastAd(e),a=mi.Q.isSurveyAd(e);return(0,v.jsxs)("div",{"data-testid":"ad-controls",className:ki,children:[(0,v.jsxs)("div",{className:Ni,children:[t&&(0,v.jsx)(hi.w,{}),(0,v.jsx)(di.T,{item:e,isDisabled:a}),t?(0,v.jsx)(pi.h,{}):(0,v.jsx)(yi.d,{})]}),(0,v.jsx)(gi.x,{}),(0,v.jsxs)("div",{className:Ci,children:[t?(0,v.jsx)(vi.v,{}):(0,v.jsx)(ii,{children:(0,v.jsx)(bi.$,{})}),(0,v.jsx)(ui.t,{item:e,isDisabled:a})]})]})}));var ji=a(20536),Ii=a(32665);var Si=a(26145),Ai=a(69618),Pi=a(64825);var wi=a(66691),Di=a(55530),Ti=a(47125);const Ei="JbGNL7qsnWz6EP_3hGvf",Ri="mkROcxw9LM6F2uuwQYjN",Bi="iAOrGKFACLqwN5OOPDOt",Li=e=>{const{className:t,...a}=e;return(0,v.jsx)("span",{className:Ri,children:(0,v.jsx)(Ti.x,{className:s()(t),...a})})};var Oi=a(35015),_i=a(77487),Fi=a(20089),Ui=a(31862);const Mi=e=>e-Date.now(),Vi=({timestamp:e,format:t=Ui.f})=>{const[a,n]=(0,i.useState)(Mi(e));return(0,i.useEffect)((()=>{n(Mi(e));const t=setInterval((()=>{n(Mi(e))}),1e3);return()=>{clearInterval(t)}}),[e]),(0,v.jsx)(v.Fragment,{children:t(a)})};var zi=a(23769),Gi=a(23763),Qi=a(92242),Ki=a(1894);const qi=e=>{const{hours:t,minutes:a,seconds:i}=(0,Ki.S)(e);return(0,Gi.j)({h:t>0?t:0,m:a,s:i})},Hi=function({setSleepTimer:e,state:t}){const a=t.type===Qi.dq.NONE?Qi.Xe:Qi.Xe.concat(Qi.k1.Off);return(0,v.jsxs)(Oi.W,{children:[(0,v.jsx)(_i.y,{children:(0,v.jsx)("span",{className:Bi,children:t.type!==Qi.dq.NONE&&t.timestamp?d.Ru.get("web-player.sleep-timer.player-controls.popover.title.timeleft",(0,v.jsx)(Vi,{timestamp:t.timestamp,format:qi})):d.Ru.get("web-player.sleep-timer.player-controls.popover.title")})}),(0,v.jsx)("div",{children:a.map((t=>(0,v.jsx)(Fi.D,{onClick:()=>{e(t)},"data-testid":`playback-sleep-timer-option-${t}`,role:"menuitemradio","aria-label":`${t}`,children:(0,zi.p)(t,Qt.c.EPISODE)},t)))})]})};var Yi=a(49733);const Wi=({onClick:e})=>{const t=(0,W.NC)(rt.GhO),[a,i]=(0,Yi.y)(),n=a.type!==Qi.dq.NONE,{timestamp:s}=a;return t?(0,v.jsx)(Di.t,{placement:"top-start",menu:(0,v.jsx)(Hi,{state:a,setSleepTimer:t=>{i(t),e?.(t)}}),children:(e,t,a)=>(0,v.jsx)($.Zp,{label:d.Ru.get("web-player.sleep-timer.player-controls.button.tooltip"),children:(0,v.jsx)(J.H,{ref:a,className:Ei,iconLeading:n?Li:wi.l,size:"small",onClick:t,role:"checkbox","aria-label":d.Ru.get("web-player.sleep-timer.player-controls.button.tooltip"),"data-testid":"control-button-sleep-timer","aria-checked":n,semanticColor:n?"textBrightAccent":void 0,children:n&&s&&(0,v.jsx)(l.E,{variant:"marginal",semanticColor:"textBrightAccent",children:(0,v.jsx)(Vi,{timestamp:s})})})})}):null};var Zi=a(18461),Xi=a(18888);const Ji=(0,i.memo)((function({isPreview:e}){const{logChangePlaybackSpeed:t,logChangeRepeatMode:a,logChangeShuffleMode:n,logSeekForward:s,logSeekBack:o,logSkipForward:r,logSkipBack:c,logPlayPause:l,logProgressChanged:u,spec:m}=(()=>{const e=(0,Ie.z)(),{videoPlayerMode:t}=(0,gt.d)(),{spec:a,logger:n}=(0,j.r)(Si.kD,{data:{identifier:t===pt.Kz.cinemaLegacy?Si.gw.CINEMA:Si.gw.DESKTOP}});return{logChangePlaybackSpeed:(0,i.useCallback)((t=>{const i=e.getState();i?.item&&n.logInteraction(a.speedControlButtonFactory().hitSetPlaybackSpeed({currentlyPlayedItem:i.item.uri,playbackSpeed:t}))}),[n,e,a]),logChangeShuffleMode:(0,i.useCallback)((e=>{n.logInteraction(e?a.shuffleButtonFactory().hitShuffleEnable():a.shuffleButtonFactory().hitShuffleDisable())}),[n,a]),logChangeRepeatMode:(0,i.useCallback)((e=>{const t={[Ai.p.REPEAT_NONE]:a.repeatButtonFactory().hitRepeatDisable(),[Ai.p.REPEAT_TRACK]:a.repeatButtonFactory().hitRepeatOneEnable(),[Ai.p.REPEAT_CONTEXT]:a.repeatButtonFactory().hitRepeatEnable()};n.logInteraction(t[e])}),[n,a]),logSeekBack:(0,i.useCallback)((e=>{n.logInteraction(a.seekBackButtonFactory().hitSeekByTime({msSeekedOffset:e}))}),[n,a]),logSeekForward:(0,i.useCallback)((e=>{n.logInteraction(a.seekForwardButtonFactory().hitSeekByTime({msSeekedOffset:e}))}),[n,a]),logSkipBack:(0,i.useCallback)((()=>{const t=e.getState();t&&n.logInteraction(a.previousButtonFactory().hitSkipToPrevious({itemToBeSkipped:t.item?.uri||"",positionMs:(0,Pi.s)(t)??-1,totalContentMs:t.duration??-1}))}),[n,e,a]),logSkipForward:(0,i.useCallback)((()=>{const t=e.getState();t?.item&&n.logInteraction(a.nextButtonFactory().hitSkipToNext({itemToBeSkipped:t.item.uri,positionMs:(0,Pi.s)(t)??-1,totalContentMs:t.duration??-1}))}),[n,e,a]),logPlayPause:(0,i.useCallback)((t=>{const i=e.getState();i?.item&&("resume"===t?n.logInteraction(a?.playPauseButtonFactory().hitResume({itemToBeResumed:i.item.uri})):"pause"===t&&n.logInteraction(a?.playPauseButtonFactory().hitPause({itemToBePaused:i.item.uri})))}),[n,e,a]),logProgressChanged:(0,i.useCallback)(((e,t)=>{switch(t){case"drag":return n.logInteraction(a.progressBarFactory().dragSeekToTime({msToSeekTo:e}));case"hit":return n.logInteraction(a.progressBarFactory().hitSeekToTime({msToSeekTo:e}));default:return(0,Ya.k)(t)}}),[n,a]),spec:a}})();ci((0,W.NC)(rt.KYh));const g=(0,H.o)((e=>e?.item??void 0),((e,t)=>e?.uri===t?.uri)),p=function(){const e=(0,H.o)((e=>e?.item??void 0),((e,t)=>e?.uri===t?.uri));return(0,pa.p)(e)||(0,Ka.d)(e)?"audio"===e.mediaType||"mixed"===e.mediaType:!!(0,Qa.N)(e)&&e.isPodcastAd}();return(0,v.jsx)("div",{className:xi,"data-testid":"player-controls",dir:"ltr","aria-label":d.Ru.get("playback-control.a11y.landmark-label"),children:(0,v.jsxs)(Ha.r,{spec:m,children:[(0,Qa.N)(g)?(0,v.jsx)(fi,{item:g}):(0,v.jsxs)("div",{className:ki,"data-testid":"general-controls",children:[(0,v.jsxs)("div",{className:Ni,children:[p?(0,v.jsx)(hi.w,{onClick:t}):(0,v.jsx)(Xi.w,{renderEnabled:()=>(0,v.jsx)(Zi.a,{size:"small"}),renderDisabled:()=>(0,v.jsx)(Ii.u,{onClick:n})}),p&&(0,v.jsx)(pi.h,{onClick:o}),(0,v.jsx)(yi.d,{onClick:c})]}),(0,v.jsx)(gi.x,{onClick:l}),(0,v.jsxs)("div",{className:Ci,children:[(0,v.jsx)(ii,{children:(0,v.jsx)(bi.$,{onClick:r})}),p?(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)(vi.v,{onClick:s}),(0,v.jsx)(Wi,{})]}):(0,v.jsx)(ji.s,{onClick:a})]})]}),(0,v.jsx)(li.x,{isPreview:e,onChange:u})]})})}));var $i=a(55354),en=a(44324),tn=a(16404);const an="main-nowPlayingBar-container",nn="main-nowPlayingBar-nowPlayingBar",sn="MWD1i_CSJ5N9wRBDpZmX",on="k3NVrHXkbfflNdAxpT1_",rn="m8UPWsNtWbdkvBNvqgBN",cn="aepuRyT82biv_XmkH1eS",ln="main-nowPlayingBar-left",un="main-nowPlayingBar-center",dn="main-nowPlayingBar-right",mn="K7b2iysmIbvKo8RqRbc5",gn="adzMqeRxU0__wQcuju5q",pn=(0,i.memo)((()=>{const{isAnonymous:e}=(0,o.d4)(K.Ht),t=(0,o.wA)(),a=(0,H.o)((e=>e),((e,t)=>e?.hasContext===t?.hasContext&&e?.item?.uri===t?.item?.uri)),n=(0,b.h)();(()=>{const e=(0,o.d4)(K.Yb),{mode:t,setMode:a}=(0,Q.r)(),n=(0,H.o)((e=>e?.item?.uri),((e,t)=>e!==t)),s=(0,z.S)(),r=(0,G.r)(),c=(0,V.l)(),l=s===M.z.NOW_PLAYING_VIEW&&"lyrics"===r.currentVariant;(0,i.useEffect)((()=>{t!==q.YU.none&&e&&t===q.YU.npv&&(a(q.YU.static),l&&c(M.z.CLOSED))}),[e,l,t,c,a,n])})();const l=(0,H.o)((e=>(0,Qa.N)(e?.item??void 0))),u=(0,i.useCallback)((e=>{e.stopPropagation(),t((0,c.Ai)())}),[t]),d=()=>(0,v.jsx)($i.ql.Provider,{value:"now_playing_bar",children:(0,v.jsxs)("div",{className:e?sn:nn,children:[(0,v.jsx)("div",{className:ln,children:(0,v.jsx)(Xa,{})}),(0,v.jsx)("div",{className:un,children:(0,v.jsx)(i.Suspense,{fallback:null,children:(0,v.jsx)(Ji,{isPreview:e})})}),(0,v.jsx)("div",{className:dn,children:(0,v.jsx)(Vt,{})})]})});return(0,v.jsx)(tn.P,{surface:en.u.NOW_PLAYING,children:(0,v.jsxs)("footer",{className:s()(an,mn,{[gn]:n}),"data-testid":"now-playing-bar","data-testadtype":"ad-type-"+(l?"ad":"none"),children:[e?(0,v.jsx)(y,{handleClick:u}):null,e?(0,v.jsx)(r.A,{in:a?.hasContext??!1,timeout:200,classNames:{enter:on,enterActive:rn,enterDone:cn},children:d()}):d(),(0,v.jsx)(U,{})]})})}))},41238:(e,t,a)=>{a.d(t,{$:()=>s});var i=a(85387);const n="/lyrics",s=()=>{const e=(0,i.zy)(),t=e.pathname.startsWith(n);return{isActive:t,isActiveNotCinemaMode:t&&(!e.state.cinemaState||"closed"===e.state.cinemaState),routeDestination:n}}}}]);
//# sourceMappingURL=dwp-now-playing-bar.js.map