"use strict";(("undefined"!=typeof self?self:global).webpackChunkclient_web=("undefined"!=typeof self?self:global).webpackChunkclient_web||[]).push([[347],{22122:(e,s,n)=>{n.d(s,{HomeSubfeedWithRedirect:()=>q});var t=n(30758),o=n(97500),i=n.n(o),a=n(33100),r=n(58574),c=n(17160),l=n(79258),h=n(58244),d=n(85328),m=n(63034),p=n(11726),u=n(68219),g=n(58146),f=n(84762),x=n(48237),j=n(62411),y=n(92574),C=n(92508),S=n(88343),_=n(5569),A=n(48981),R=n(72540),b=n(15930),w=n(5408),N=n(24e3),$=n(75871),v=n(64390),k=n(86070);const I=(0,t.memo)((({cardCount:e})=>(0,k.jsx)("section",{children:(0,k.jsx)("div",{className:i()(v.A.home,v.A.homepage),children:(0,k.jsx)("div",{className:i()(v.A.homepageContent,"contentSpacing"),children:(0,k.jsx)(u.f,{showAll:!0,cardCount:e,withTitle:!1})})})}))),P=({sectionURIs:e})=>{const s=(0,a.NC)(R.wWq),{data:n,error:o,loading:l,extensions:d}=(0,S.$o)({uris:e,timeZone:(0,_.Ff)(),sp_t:(0,b.v8)("sp_t")??"",sectionItemsLimit:s??10},{gcTime:_.gO,staleTime:_.jl}),p=(0,m.getRequestIdForImpressions)(d),{spec:u}=(0,N.$)(r.Y,{data:{identifier:"home/pinned",uri:"spotify:home:pinned",reason:p??""}}),g=(0,j.d4)((e=>e.session.user)),f=(0,t.useCallback)((()=>{const s=new URL("https://open.spotify.com/home");s.searchParams.set("facet","pinned-by"),s.searchParams.set("hpuris",e.map((e=>e.replace("spotify:section:",""))).join(",")),s.searchParams.set("hpname",g?.display_name??g?.id??""),(0,$.l)(s.toString()),(0,x.M8)(c.Ru.get("feedback.link-copied"))}),[e,g?.display_name,g?.id]);return l?(0,k.jsx)(I,{cardCount:10}):null!==o||"HomeSectionCollection"!==n?.homeSections.__typename?(0,k.jsx)(h.LoadingPage,{hasError:!0,errorMessage:c.Ru.get("error.generic")}):(0,k.jsx)(w.r,{spec:u,children:(0,k.jsxs)("section",{"data-testid":"home-pin-page",className:i()(v.A.home,v.A.homepageWithCarousels),children:[(0,k.jsx)("div",{className:i()(v.A.homePinButton,"contentSpacing"),children:(0,k.jsx)(y.$,{iconLeading:C.C,onClick:f,size:"small",children:"Share your home"})}),(0,k.jsx)("div",{className:i()(v.A.homepageContent,"contentSpacing"),children:n.homeSections.sections.map(((e,s)=>"HomeSection"!==e.__typename?null:(0,k.jsx)(A.Q,{section:e,index:s,greeting:null},`${s}-${e.uri}`)))})]})})};var M=n(62148),L=n(75432),H=n(21643),D=n(4164);const T=(0,t.memo)((({cardCount:e})=>(0,k.jsxs)("div",{className:i()(v.A.homepageContent,"contentSpacing"),children:[(0,k.jsx)(l.y,{withTitle:!1}),(0,k.jsx)(u.f,{showAll:!0,cardCount:e,withTitle:!1})]}))),U=()=>{const e=(0,f.f)(),{data:s,loading:n,error:o,extensions:a}=(0,H.f)(),l=(0,t.useRef)(null);(0,d.b)(l);const u=e.replace("-chip",""),{spec:x}=(0,N.$)(r.Y,{data:{identifier:u?`home/${u}`:"",uri:`spotify:home:${u}`,reason:(0,m.getRequestIdForImpressions)(a)??""}}),j=s?.home;if(n)return(0,k.jsx)("section",{"data-testid":"home-subfeed-page",className:i()(v.A.home,v.A.homepageWithCarousels),children:(0,k.jsx)(T,{cardCount:50})});if(null!==o)return(0,k.jsx)(h.LoadingPage,{hasError:!0,errorMessage:c.Ru.get("error.generic")});if("HomeResponsePayload"!==j?.__typename)return(0,k.jsx)(h.LoadingPage,{hasError:!0,errorMessage:c.Ru.get("error.generic")});const y=j.sectionContainer.sections.items;return 0===y.length?(0,k.jsx)(h.LoadingPage,{hasError:!0,errorMessage:c.Ru.get("error.generic")}):("HomeShortsSectionData"!==y[0]?.data?.__typename&&(e=>s=>"HomeShortsSectionData"===s.data?.__typename||"spotify:section:0JQ5DAnM3wGh0gz1MXnu3N"===s.uri&&"podcasts-chip"===e||("spotify:section:0JQ5DAJvCyzyxqjq31tlEs"===s.uri||"spotify:section:0JQ5DAnM3wGh0gz1MXnucs"===s.uri)&&e===g.e)(e)(y[0])&&(j.sectionContainer.sections.items[0]={...y[0],data:{...y[0].data,__typename:"HomeShortsSectionData"}}),(0,k.jsx)(w.r,{spec:x,children:(0,k.jsx)("section",{ref:l,"data-testid":"home-subfeed-page",className:i()(v.A.home,v.A.homepageWithCarousels),children:(0,k.jsx)("div",{className:i()(v.A.homepageContent,"contentSpacing"),children:(0,k.jsx)(p.g,{container:j.sectionContainer,greeting:null,enableFeedBaseline:!0})})})}))},q=()=>{const e=(0,f.f)(),{shelfURIs:s}=(0,M.T)(),n=(0,L.k)();if((0,a.NC)(R._Ie)){if("pinned-by"===e&&n){const e=n?.uris;return e.length?(0,k.jsx)(P,{sectionURIs:e}):(0,k.jsx)(D.$,{to:"/"})}if("pinned"===e){const e=s;return e.length?(0,k.jsx)(P,{sectionURIs:e}):(0,k.jsx)(D.$,{to:"/"})}}return e?(0,k.jsx)(U,{}):(0,k.jsx)(D.$,{to:"/"})}},75432:(e,s,n)=>{n.d(s,{k:()=>o});var t=n(85387);const o=()=>{const e=(0,t.zy)(),s=new URLSearchParams(e.search);if(!s.has("hpuris"))return null;const n=(s.get("hpuris")||"").split(",").map((e=>`spotify:section:${e}`));return{name:s.get("hpname")??"Shared",uris:n}}}}]);
//# sourceMappingURL=home-subfeed.js.map